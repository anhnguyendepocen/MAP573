<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R for Statistics</title>
  <meta name="description" content="R for Statistics">
  <meta name="generator" content="bookdown 0.4 and GitBook 2.6.7">

  <meta property="og:title" content="R for Statistics" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R for Statistics" />
  
  
  

<meta name="author" content="Julie Josse">


<meta name="date" content="2017-10-30">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="reproducible.html">
<link rel="next" href="homework-exploratory-analysis.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-0.9/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.4/dygraphs.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Syllabus</a></li>
<li class="chapter" data-level="2" data-path="what-is-r.html"><a href="what-is-r.html"><i class="fa fa-check"></i><b>2</b> What is R?</a></li>
<li class="chapter" data-level="3" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html"><i class="fa fa-check"></i><b>3</b> Getting Started with R</a></li>
<li class="chapter" data-level="4" data-path="reproducible.html"><a href="reproducible.html"><i class="fa fa-check"></i><b>4</b> Reproducible research</a></li>
<li class="chapter" data-level="5" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>5</b> Graphics</a><ul>
<li class="chapter" data-level="5.1" data-path="graphics.html"><a href="graphics.html#classical-plots"><i class="fa fa-check"></i><b>5.1</b> Classical plots</a><ul>
<li class="chapter" data-level="5.1.1" data-path="graphics.html"><a href="graphics.html#representing-1-variables"><i class="fa fa-check"></i><b>5.1.1</b> Representing 1 variables</a></li>
<li class="chapter" data-level="5.1.2" data-path="graphics.html"><a href="graphics.html#reprensenting-2-variables"><i class="fa fa-check"></i><b>5.1.2</b> Reprensenting 2 variables</a></li>
<li class="chapter" data-level="5.1.3" data-path="graphics.html"><a href="graphics.html#saving-graphical-outputs"><i class="fa fa-check"></i><b>5.1.3</b> Saving graphical outputs</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="graphics.html"><a href="graphics.html#ggplot2"><i class="fa fa-check"></i><b>5.2</b> Ggplot2</a><ul>
<li class="chapter" data-level="5.2.1" data-path="graphics.html"><a href="graphics.html#scatter-plots"><i class="fa fa-check"></i><b>5.2.1</b> Scatter plots</a></li>
<li class="chapter" data-level="5.2.2" data-path="graphics.html"><a href="graphics.html#facets"><i class="fa fa-check"></i><b>5.2.2</b> facets</a></li>
<li class="chapter" data-level="5.2.3" data-path="graphics.html"><a href="graphics.html#more-options"><i class="fa fa-check"></i><b>5.2.3</b> more options</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="graphics.html"><a href="graphics.html#first-interactive-graphs"><i class="fa fa-check"></i><b>5.3</b> First interactive graphs</a></li>
<li class="chapter" data-level="5.4" data-path="graphics.html"><a href="graphics.html#spatial-graphs"><i class="fa fa-check"></i><b>5.4</b> Spatial graphs</a></li>
<li class="chapter" data-level="5.5" data-path="graphics.html"><a href="graphics.html#going-further"><i class="fa fa-check"></i><b>5.5</b> Going further</a><ul>
<li class="chapter" data-level="5.5.1" data-path="graphics.html"><a href="graphics.html#cross-validation"><i class="fa fa-check"></i><b>5.5.1</b> Cross-validation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="homework-exploratory-analysis.html"><a href="homework-exploratory-analysis.html"><i class="fa fa-check"></i><b>6</b> Homework: exploratory analysis</a></li>
<li class="chapter" data-level="7" data-path="tests.html"><a href="tests.html"><i class="fa fa-check"></i><b>7</b> Tests</a></li>
<li class="chapter" data-level="8" data-path="homework-tests.html"><a href="homework-tests.html"><i class="fa fa-check"></i><b>8</b> Homework: tests</a></li>
<li class="chapter" data-level="9" data-path="principal-components-analysis.html"><a href="principal-components-analysis.html"><i class="fa fa-check"></i><b>9</b> Principal components analysis</a></li>
<li class="chapter" data-level="10" data-path="homework-pca.html"><a href="homework-pca.html"><i class="fa fa-check"></i><b>10</b> Homework: PCA</a></li>
<li class="chapter" data-level="11" data-path="handling-missing-values.html"><a href="handling-missing-values.html"><i class="fa fa-check"></i><b>11</b> Handling missing values</a></li>
<li class="chapter" data-level="12" data-path="shiny-app.html"><a href="shiny-app.html"><i class="fa fa-check"></i><b>12</b> Shiny App</a></li>
<li class="chapter" data-level="13" data-path="ref.html"><a href="ref.html"><i class="fa fa-check"></i><b>13</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="graphics" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Graphics</h1>
<!-- fiche ggplot de laurent -->
<p>R is known for its amazing high quality graphics. Graphs are crucial to better understand the data, spotlight outliers, help for the modeling part and are of course an incredible tool of communication.</p>
<p><img src="pic/facebook.jpg" width="50%" style="display: block; margin: auto;" /></p>
<p>Creating graphics and suggesting the appropriate visualization is not a trivial task and is a field of research. (you can have a look at blogs dedicated to visualizations such as <a href="http://flowingdata.com/">FlowingData</a> to get inspired).</p>
<p>This <a href="https://en.wikipedia.org/wiki/Anscombe%27s_quartet#cite_note-7">Anscombe’s quartet example</a> is often used to show that graphs are important since we may be fooled by numbers only. <a href="https://www.autodeskresearch.com/publications/samestats">Recent visualization</a> However, as you know, we may also be fooled by graphs.</p>
<p>The original system to make graphics in R is still very much used. The graphics are easy to make and can be customized to a large extent (look at <a href="http://www.r-graph-gallery.com/">this gallery</a> for a snapshot). However, graphs made with the package <strong>ggplot2</strong> are becoming mainstream (<a href="https://www.google.fr/search?q=ggplot2&amp;espv=2&amp;biw=1348&amp;bih=740&amp;source=lnms&amp;tbm=isch&amp;sa=X&amp;ved=0ahUKEwjgzZP40_XOAhWHfxoKHTAlB-cQ_AUIBigB&amp;dpr=0.9">some examples</a>). <a href="https://www.youtube.com/watch?v=9Objw9Tvhb4">Here</a> Brian Caiffo’s opinion on learning ggplot2 versus base R graphics. We have also to keep in mind that amongst the 11000 packages many are using R base graphics.</p>
<p>Map and spatial data analysis can be obtained with packages such as ggmap (which used Google Maps), maptools, tmap, etc. This is of course a huge field. You can see the task view for a complete list. I would suggest the webpage of <a href="https://rgeomatic.hypotheses.org/author/rgeomatic">Timothée Giraud</a>, a main contributor on this topic as well as this <a href="https://edzer.github.io/UseR2017/">tutorial</a> also gives many references for spatial data.</p>
<p>Colors may be improved using RColorBrewer, ColorBrewer, ColorRamp, ColorRampPalette packages.</p>
<p>Interactives graphics can be obtained for instance with:<br />
- googleVis to interface with google charts (as in this famous <a href="https://www.ted.com/talks/hans_rosling_shows_the_best_stats_you_ve_ever_seen">this TED talk</a>) Some examples can be found <a href="https://cran.r-project.org/web/packages/googleVis/vignettes/googleVis_examples.html">here</a>.</p>
<p>-ggvis<br />
…</p>
<p>One of the latest amazing visualization tools in R are <a href="http://www.htmlwidgets.org/showcase_leaflet.html">HTML widgets</a>, that we will use! HTML widgets use JavaScript libraries in R in a integrated way to create interactive web visualization such as dynamic maps (leaflet), time-series data charting (dygraphs), and interactive tables (DataTables), interactive plots with <a href="https://plot.ly/ggplot2/">plotly</a>, that we will use! Plotly gives the possibility to create interactive D3.js graphs with R. Plots can be shared with a private or public URL and the interactive graphs can be embedded in knitr docs, dashboards, websites, and Shiny Apps. <a href="http://shiny.rstudio.com/gallery/">Shiny</a> is of course a great way to share the results.</p>
<div id="classical-plots" class="section level2">
<h2><span class="header-section-number">5.1</span> Classical plots</h2>
<p>Just one piece of advice, avoid pie plots! Look at the help of pie chart (help(pie)):</p>
<p><em>Pie charts are a very bad way of displaying information. The eye is good at judging linear measures and bad at judging relative areas. A bar chart or dot chart is a preferable way of displaying this type of data</em></p>
<div id="representing-1-variables" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Representing 1 variables</h3>
<p>To represent a quantitative variable, histogram and kernel density estimates can be used. To represent the estimate of the target distribution based on the data, the histogram estimates the density if we specify the argument prob = TRUE (equivalent to freq=FALSE) of the hist function.</p>
<p>A kernel density estimate of the variable can be obtained using the density function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(ozone[,<span class="st">&quot;maxO3&quot;</span>], <span class="dt">main =</span> <span class="st">&quot;Histogram&quot;</span>, <span class="dt">probability =</span> <span class="ot">TRUE</span>, <span class="dt">xlab =</span> <span class="st">&quot;Ozone&quot;</span>, <span class="dt">col =</span> <span class="dv">4</span>)
<span class="kw">lines</span>(<span class="kw">density</span>(ozone[,<span class="st">&quot;maxO3&quot;</span>]))
<span class="kw">rug</span>(ozone$maxO3)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div id="definitions" class="section level4">
<h4><span class="header-section-number">5.1.1.1</span> Definitions</h4>
<p>Assume that the data are modeled as <span class="math inline">\(n\)</span> independent and identically distributed random variables <span class="math inline">\((X_1,\ldots,X_n)\)</span> with the same unknown probability distribution <span class="math inline">\(p_{\star}\)</span> with respect to the Lebesgue measure on <span class="math inline">\(\mathbb{R}\)</span>. A kernel density estimate of <span class="math inline">\(p_{\star}\)</span> can be introduced using a bandwith <span class="math inline">\(h\in\mathbb{R}_{+}^{\star}\)</span> and a kernel <span class="math inline">\(K\)</span> defined on <span class="math inline">\(\mathbb{R}\)</span> such that <span class="math inline">\(\int_{\mathbb{R}}K(x)\mathrm{d}x = 1\)</span>. The kernel density estimate <span class="math inline">\(\hat{p}_{n,h}\)</span> is defined by (see Rosenblatt, 1956): <span class="math display">\[
\hat{p}_{n,h}: x\mapsto \frac{1}{nh}\sum_{i=1}^{n}K\left(\frac{x-X_i}{h}\right)\,.
\]</span> Several kernel functions <span class="math inline">\(K\)</span> may be used, for instance: <span class="math display">\[
\mbox{(Triangular)} \quad K: x\mapsto (1-|x|)\mathbf{1}_{(-1,1)}(x)\,,\\
\mbox{(Epanechikov)} \quad K: x\mapsto \frac{3}{4}(1-x^2)\mathbf{1}_{(-1,1)}(x)\,,\\
\mbox{(Gaussian)} \quad K: x\mapsto (2\pi)^{-1/2}\mathrm{e}^{-x^2/2}\,.
\]</span> Minimizing the mean square error of this estimate requires a fair amount of tuning as the bias and the variance of <span class="math inline">\(\hat{p}_{n,h}\)</span> depend on smoothness assumptions on <span class="math inline">\(p_{\star}\)</span>, on the choice of <span class="math inline">\(h\)</span> as a function of <span class="math inline">\(n\)</span>, and on the properties of <span class="math inline">\(K\)</span> (moments assumptions for instance).</p>
<p>Histogram estimates offer an alternative for the graphical representation of the density <span class="math inline">\(p_{\star}\)</span>. Assume for instance that <span class="math inline">\(p_{\star}\)</span> is defined on <span class="math inline">\([0,1)\)</span> and let <span class="math inline">\((C_1,\ldots,C_m)\)</span> be a partition of <span class="math inline">\([0,1)\)</span> (a common choice is given by <span class="math inline">\(C_i=[\frac{i-1}{m},\frac{i}{m})\)</span> for <span class="math inline">\(1\le i \le m\)</span>). The histogram estimate associated with this partition is defined as follows, with <span class="math inline">\(h=1/m\)</span>: <span class="math display">\[
\widetilde{p}_{n,h}: x\mapsto \frac{1}{nh}\sum_{i=1}^{n}\sum_{j=1}^{m}\mathbf{1}_{C_j}(X_i)\mathbf{1}_{C_j}(x) = \frac{1}{h}\sum_{j=1}^{m}\left(\frac{1}{n}\sum_{i=1}^{n}\mathbf{1}_{C_j}(X_i)\right)\mathbf{1}_{C_j}(x)\,.
\]</span> In this setting, minimizing the mean square error of <span class="math inline">\(\widetilde{p}_{n,h}\)</span> requires a sharp choice of <span class="math inline">\(m\)</span> as a function of <span class="math inline">\(n\)</span>.</p>
<p>Look at the help of the function to see the different options such as the number of intervals.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(ozone[,<span class="st">&quot;maxO3&quot;</span>],<span class="dt">main=</span><span class="st">&quot;Histogram&quot;</span>, <span class="dt">probability =</span> <span class="ot">TRUE</span>, <span class="dt">xlab =</span> <span class="st">&quot;Ozone&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">breaks =</span> <span class="dv">30</span>)
<span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">median</span>(ozone[,<span class="st">&quot;maxO3&quot;</span>]), <span class="dt">lwd =</span> <span class="dv">4</span>, <span class="dt">col =</span> <span class="st">&quot;darkblue&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># abline (h = ) draw an horizontal line</span></code></pre></div>
<p>The <em>breaks</em> argument allows to specify the cells to be displayed in the histogram, i.e. the <span class="math inline">\(C_j\)</span>’s in the definition of <span class="math inline">\(\widetilde{p}_{n,h}\)</span>. This argument may be given as a number or a vector providing explicitly the coordinates of the breakpoints for instance.</p>
<p>Other arguments may be used to get fancy histograms such as <em>col</em> (defined as a string) to choose the color used to fill each cell.</p>
<p>The function <em>hist()</em> returns a list of components wich can be used to monitor precisely the histogram or modify the way it is displayed.</p>
<p>To represent the distribution of a qualitative variable, we use a bar chart, obtained using the barplot function. We must count the number of occurrences at each level using the table function. For the factor wind:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(<span class="kw">table</span>(ozone[, <span class="st">&quot;wind&quot;</span>]))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>It is also possible to use the plot function directly on the vector of the categories:</p>
<p><code>r   plot(ozone[, &quot;wind&quot;])</code> The function plots according to the type of variable and selects the appropriate representations.</p>
</div>
</div>
<div id="reprensenting-2-variables" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Reprensenting 2 variables</h3>
<p>Let us start by representing two quantitative variables: maximum ozone according to temperature at 9am:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(maxO3 ~<span class="st"> </span>T9, <span class="dt">data =</span> ozone) </code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Note that it is also possible to write</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(ozone[,<span class="st">&quot;T9&quot;</span>], ozone[,<span class="st">&quot;maxO3&quot;</span>]) </code></pre></div>
<p>but in statistic, we prefer the version with a formulae plot(y~x, data = mydata) “y explained by x”.</p>
<p>Similarly, to represent a quantitative variable maxO3 according to a qualitative variable wind:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(maxO3 ~<span class="st"> </span>wind,  <span class="dt">data =</span> ozone)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>In this case, the plot function automatically yields a boxplot for each category of the variable wind. The boxes are the interquartile range (IQR). The horizontal line is the sample median. The wiskers correspond to the largest (smallest) observation that is no more than 1.5 times the IQR away from the upper (lower) quartile. Any points that not are inside the whiskers are plotted as a point. The variable wind has an effect on the ozone: the easterly wind seems to be associated with high concentrations of ozone. This graph can also be obtained using the boxplot function.</p>
<p>Individuals above the higher whisker are often considered to be outliers. The component out from the ouput list of the boxplot function gives us the outliers’ values.</p>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(res)</code></pre></div>
<pre><code>## [1] &quot;stats&quot; &quot;n&quot;     &quot;conf&quot;  &quot;out&quot;   &quot;group&quot; &quot;names&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">outliers &lt;-<span class="st"> </span>res$out
outliers</code></pre></div>
<pre><code>## [1]  45 153 159 145 149 149 156 131 166</code></pre>
<p>To identify the individuals we can use the operator {%in%} which outputs TRUE or FALSE depending on whether or not the value is within the set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ind_out &lt;-<span class="st"> </span><span class="kw">which</span>(ozone[,<span class="st">&quot;maxO3&quot;</span>]%in%outliers)
ind_out</code></pre></div>
<pre><code>##  [1] 17 40 52 53 54 55 57 78 79 80</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#ozone[ind_out, &quot;maxO3&quot;]</span></code></pre></div>
<p>Individuals ind_out are therefore the outliers. Another way of identifying these outliers is to use the identify function. By clicking on a point on a graph, the function yields the row number corresponding to this individual. The identify function takes the abscissa and ordinate values from the scatter plot as the arguments:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">identify</span>(ozone$wind,ozone$maxO3)</code></pre></div>
<p>When you have finished, simply click elsewhere in the graph window with the right button of the mouse, or type Esc in the command window.</p>
<p>We can also represent two qualitative variables using a bar chart. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(rain ~<span class="st"> </span>wind, <span class="dt">data =</span> ozone)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>can be used to obtain, for each category of the explanatory factor (here wind), the relative frequencies for each category of the response factor rain. The width of the bar is proportional to the frequency of the category of the explanatory factor (here wind). This graph can also be obtained using the spineplot function. We find that the weather type``rain’’ is proportionally greater when the wind blows from the west. Furthermore, as this is the widest bar, we can also conclude that this is the most common wind direction in Rennes.</p>
<p>Finally, the function pairs can be used to draw all of the bivariate plots:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pairs</span>(ozone[, <span class="dv">1</span>:<span class="dv">5</span>])</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Let’s represent the daily ozone evolution for the first week.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(ozone[<span class="dv">1</span>:<span class="dv">7</span>,<span class="st">&quot;maxO3&quot;</span>],<span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Max O3&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;1 week of ozone&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>This is a very classical graph for representing temporal data.</p>
<p>To compare, for example, the evolution of maximum ozone levels over two different weeks, we can proceed as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(ozone[<span class="dv">1</span>:<span class="dv">7</span>,<span class="st">&quot;maxO3&quot;</span>],<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)
<span class="kw">lines</span>(ozone[<span class="dv">8</span>:<span class="dv">14</span>,<span class="st">&quot;maxO3&quot;</span>],<span class="dt">col=</span><span class="st">&quot;grey50&quot;</span>) <span class="co"># add lines (2nd week)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>The graph does not show the sixth and sewindh observations for this second week since the graph window is scaled when the plot function is used (and is not rescaled after the use of lines). Consequently, ylim options may be specified as follows:</p>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>There are a bunch of graphics options for plots. See ?plot.default and ?par.</p>
<p>Days to days one are the following:<br />
* main (title), sub (subtitle), xlab, ylab (axes labels)<br />
* type: n (none), p (points - default), l (join points by line), b (both points and lines), h (vertical bar), “o” (points and lines overlaid) * pch: shape of points (between 0 and 25, 0 point, 2 triangle, 3 cross, etc)<br />
* cex: size of the symbol (par défaut 1, <span class="math inline">\(&gt;1\)</span> blow-up, <span class="math inline">\(&lt;1\)</span> decrease), cex.main, cex.axis<br />
* lty: (line type) 1 plain, 2 dashed, 3 dotted * xlim: xlim = c(0,300) - ylim<br />
* axes: draw axes (TRUE ou FALSE)<br />
* par(mfrow=c(n,p)) to open a graphical panel with <span class="math inline">\(n\)</span> rows and <span class="math inline">\(p columns\)</span></p>
<p>### Adding information on a graph</p>
<p>There are many ways to add other information to get deeper into the comprehension of the data and highlight some features. We can add variables, texts, colors, etc…</p>
<p>It is possible to add another variable simply by using colors and coloring according to the categories of a categorical variable for instance.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(maxO3~T9,<span class="dt">col=</span><span class="kw">as.integer</span>(ozone$wind), <span class="dt">data =</span> ozone, <span class="dt">cex =</span> <span class="fl">0.8</span>)
<span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="kw">levels</span>(ozone[,<span class="st">&quot;wind&quot;</span>]),
       <span class="dt">fil=</span><span class="dv">1</span>:<span class="kw">nlevels</span>(ozone[,<span class="st">&quot;wind&quot;</span>]))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>Let’s represent the ozone maxima according to temperature T12 and add the date and the information on rain/not rain. To make the date appear we need to add text to the scatterplot. Nonetheless, in order to avoid overlapping the symbols (the small circles) and the names, we do not draw any symbols (type=“n”). We simply write the month and the day (i.e. the last four characters of the row names) with a reduced font size (cex=.5). Thew, we will the coordinates of rainy days and add red dots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">selection &lt;-<span class="st"> </span>ozone[,<span class="st">&quot;rain&quot;</span>]==<span class="st">&quot;Rainy&quot;</span>
<span class="kw">plot</span>(maxO3~T12,<span class="dt">data=</span>ozone,<span class="dt">type=</span><span class="st">&quot;n&quot;</span>)
<span class="kw">text</span>(ozone[,<span class="st">&quot;T12&quot;</span>],ozone[,<span class="st">&quot;maxO3&quot;</span>],<span class="kw">substr</span>(<span class="kw">rownames</span>(ozone),<span class="dv">5</span>,<span class="dv">8</span>),  <span class="dt">cex=</span>.<span class="dv">5</span>, <span class="dt">pos =</span> <span class="dv">3</span>)
<span class="kw">points</span>(ozone[selection,<span class="st">&quot;T12&quot;</span>],ozone[selection,<span class="st">&quot;maxO3&quot;</span>], <span class="dt">pch=</span><span class="dv">21</span>,<span class="dt">bg=</span><span class="st">&quot;red&quot;</span>,<span class="dt">cex=</span>.<span class="dv">5</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
</div>
<div id="saving-graphical-outputs" class="section level3">
<h3><span class="header-section-number">5.1.3</span> Saving graphical outputs</h3>
<p>Graphs can be saved in any common format (png, jpeg, pdf, svg) either by clicking on save as or by using:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pdf</span>(<span class="st">&quot;myplot.pdf&quot;</span>)
<span class="kw">plot</span>(..)
<span class="kw">dev.off</span>()</code></pre></div>
</div>
</div>
<div id="ggplot2" class="section level2">
<h2><span class="header-section-number">5.2</span> Ggplot2</h2>
<p>ggplot2 is an implementation by <a href="http://hadley.nz/">Hadley Wickam</a> (a key and popular personage in the R community) of Wilkinson’s Grammar of graphics which defines what a statistical graphic is. Many information can be found at <a href="http://ggplot2.org/">ggplot website</a> but for a quick summary look at these two pages <a href="https://www.rstudio.com/wp-content/uploads/2016/11/ggplot2-cheatsheet-2.1.pdf">Cheat Sheet</a>. A complete <a href="https://github.com/hadley/ggplot2-book">book</a> that you can buy is also available but this <a href="http://r4ds.had.co.nz/data-visualisation.html">online (free) book</a> could be useful to start.</p>
<p>“The grammar tells us the statistical graphic is <strong>mapping</strong> from data to <strong>aesthetic</strong> attributes (color, shape and size) of <strong>geometric objects</strong> (points, lines, and bars). The plot may also contain <strong>statistical transformations</strong> of the data and is drawn on a <strong>specific coordinate system</strong>.”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)</code></pre></div>
<p>Let’s start with the qplot function (quick plot) which is the counterpart of the plot function with many built-in features. You can have a look at some examples with the command ‘example(qplot)’.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(T12, maxO3, <span class="dt">data =</span> ozone, <span class="dt">color =</span> rain)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>For completeness, I put many capabilities of the qplot function, but to go deeper into ggplot2, we should use its own specific syntax where plots are built with layers.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(T12, maxO3, <span class="dt">data =</span> ozone, <span class="dt">geom =</span> <span class="kw">c</span>(<span class="st">&quot;point&quot;</span>, <span class="st">&quot;smooth&quot;</span>))
<span class="kw">qplot</span>(maxO3, <span class="dt">data =</span> ozone, <span class="dt">fill =</span> rain)
<span class="kw">qplot</span>(maxO3, <span class="dt">data =</span> ozone, <span class="dt">geom =</span> <span class="st">&quot;density&quot;</span>, <span class="dt">color =</span> wind)
<span class="kw">qplot</span>(T12, maxO3, <span class="dt">data =</span> ozone, <span class="dt">facets  =</span> .~wind)
<span class="kw">qplot</span>(maxO3, <span class="dt">data =</span> ozone, <span class="dt">facets  =</span> rain~.)
<span class="kw">qplot</span>(T12, maxO3, <span class="dt">data =</span> ozone, <span class="dt">color =</span> rain) +<span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span> <span class="st">&quot;lm&quot;</span>)</code></pre></div>
<p>A ggplot is build with independent elements that form the grammar: * data (ggplot): a data frame * aesthetics (aes): variables to represent (color, size, fill) * geometrics (geom): graphical representation * statistics (stat): statistical treatment</p>
<p>We use ggplot to specify the dataset used as well as the aesthetics, i.e. the variables to display with their mapping. Once this is done, one can add a geometry to obtain the plot. If you want to color the points, it is just a matter of adding this to the aesthetic list.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ozone, <span class="kw">aes</span>(<span class="dt">x =</span> wind)) +<span class="st"> </span><span class="kw">geom_bar</span>()</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ozone, <span class="kw">aes</span>(<span class="dt">x =</span> wind, <span class="dt">fill =</span> wind)) +<span class="st"> </span><span class="kw">geom_bar</span>()</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<!--
Les variables seront spécifiées dans la
fonction aes. Cette fonction admet également des arguments tels que color, size,
fill. Ces arguments sont à utiliser lorsqu’une couleur ou une taille est définie à
partir d’une variable du jeu de données.-->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ozone, <span class="kw">aes</span>(<span class="dt">x =</span> wind, <span class="dt">fill =</span> rain)) +<span class="st"> </span><span class="kw">geom_bar</span>()  +<span class="st"> </span><span class="kw">coord_flip</span>() +<span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;Rain&quot;</span>)   </code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<p>This latter option ‘coord_flip’ flips the Cartesian coordinates. It is very useful when we have labels that are not nicely displayed in the x-axis.</p>
<p>A stacked bar chart is the default type produced by ggplot2. The plot of the counts for each combination of categories side by side can be displayed with by assigning a value of “dodge” to the position argument of geom_bar:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ozone, <span class="kw">aes</span>(<span class="dt">x =</span> wind, <span class="dt">fill =</span> rain)) +<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) </code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<p>For an histogram, there are no obvious bin numbers (in comparison to barplots), this parameter need to be specified:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> ozone, <span class="kw">aes</span>(<span class="dt">x =</span> T15)) +<span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">30</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<p>Lots of arguments can be tuned to modify the default graphs produced by geom_histogram(). The default number of cells is <span class="math inline">\(30\)</span>, it may be chosen using the argument <em>bins</em>. The argument <em>binwidth</em>, which sets the width of each cell, provides another way to change the generic display of geom_histogram().</p>
<p>Lines styles are modified with the arguments <em>color</em> and <em>linetype</em>, the cells color is set with <em>fill</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(ozone, <span class="kw">aes</span>(maxO3)) +<span class="st"> </span><span class="kw">geom_density</span>(<span class="kw">aes</span>(<span class="dt">color=</span>wind))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<p>A kernel density estimate such as <span class="math inline">\(\hat{p}_{n,h}\)</span> is obtained with geom_density(). The two main arguments that have to be chosen are <em>kernel</em> to select the kernel function <span class="math inline">\(K\)</span> in the definition of <span class="math inline">\(\hat{p}_{n,h}\)</span> and <em>bw</em> to define the bandwith <span class="math inline">\(h\)</span>.</p>
<div id="scatter-plots" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Scatter plots</h3>
<p>In this family of plot, we are looking at the value of one variable with respect to another.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mygplot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(ozone, <span class="kw">aes</span>(T12, maxO3))
<span class="kw">summary</span>(mygplot)</code></pre></div>
<pre><code>## data: maxO3, T9, T12, T15, Ne9, Ne12, Ne15, Wx9, Wx12, Wx15,
##   maxO3y, wind, rain [112x13]
## mapping:  x = T12, y = maxO3
## faceting: &lt;ggproto object: Class FacetNull, Facet&gt;
##     compute_layout: function
##     draw_back: function
##     draw_front: function
##     draw_labels: function
##     draw_panels: function
##     finish_data: function
##     init_scales: function
##     map: function
##     map_data: function
##     params: list
##     render_back: function
##     render_front: function
##     render_panels: function
##     setup_data: function
##     setup_params: function
##     shrink: TRUE
##     train: function
##     train_positions: function
##     train_scales: function
##     vars: function
##     super:  &lt;ggproto object: Class FacetNull, Facet&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mygplot &lt;-<span class="st"> </span>mygplot +<span class="st"> </span><span class="kw">geom_point</span>()
<span class="kw">print</span>(mygplot)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mygplot +<span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> wind))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-37-2.png" width="672" /> The roles of the two are symmetric, except when a smoother is used. A smoother (lowess) allows to see the overall trend in the data set. A 95% confidence intervals for that line are indicated by the gray zone.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mygplot +<span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>)  +<span class="st"> </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;MaxO3 versus T12&quot;</span>, <span class="dt">x  =</span> <span class="st">&quot;Temperature at noon&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Pollutant&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(ozone, <span class="kw">aes</span>(T12, maxO3)) +<span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> rain)) +<span class="st"> </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">color =</span> rain), <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>) </code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
</div>
<div id="facets" class="section level3">
<h3><span class="header-section-number">5.2.2</span> facets</h3>
<p>Another powerful feature of ggplot2 are called facets (panels). The idea is to represent a plot for each category of a factor (as an alternative to color each points according to its category). To do so, you need to specify the facets variable. The format is a variable on the left-hand side (indicating the number of rows), a tilde and a variable on the right-hand side (indicating the number of columns). A dot is used if you do not have rows or colomns. The idea is that one can facet a given graph in a multiplicity of small graphs.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mygplot  +<span class="st"> </span><span class="kw">facet_grid</span>(.~wind)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<!--Si on souhaite obtenir les lissages sur des graphes séparés, on utilisera les fonctions
facet_grid ou facet_wrap. Ces fonctions admettent comme argument une formule
de la forme var1~var2. Elles renverront en sortie la représentation souhaitée calculée
sur les individus appartenant à chaque croisement des modalités de var1 et
var2. La seule différence entre ces deux fonctions se situe dans la disposition des
graphiques. facet_grid produira un tableau de graphes de dimension n1 × n2 où
n1 et n2 représentent les nombres de modalités de var1 et var2. Chaque graphe
correspondra à la représentation des individus possédant les modalités de la ligne
et la colonne correspondants aux deux variables. facet_wrap calculera tous les
croisements et représentera les graphes associés les uns à la suite des autres. On
pourra par exemple représenter le nuage de points carats×price ainsi que la
droite de régression associée pour chaque croisement des variables color et cut
avec (voir figure 3.43) :
-->
</div>
<div id="more-options" class="section level3">
<h3><span class="header-section-number">5.2.3</span> more options</h3>
<p>Then of course, there are many options and functions that can be used. You can specify the background colors with the theme function, the position of the legend, etc. Here some examples:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mygplot +<span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">color =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="dv">1</span>/<span class="dv">2</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<p>The color is steel blue, the size of the points is increased to be 4 (the default is 1) and the alpha is the transparency set to be one half rather than solid.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(displ, hwy)) +<span class="st"> </span><span class="kw">geom_point</span>() +<span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">linetype =</span> <span class="dv">3</span>, <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se  =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<!-- Facets: conditional plots x  
%Stats: statistical transformations like smoothing, binning, quantiles, regression
Scales: how the different variables are coded, in terms of the plot. 
Coordinate system
-->
</div>
</div>
<div id="first-interactive-graphs" class="section level2">
<h2><span class="header-section-number">5.3</span> First interactive graphs</h2>
<p>Let’s download plotly!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(plotly)</code></pre></div>
<pre><code>## 
## Attaching package: &#39;plotly&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     last_plot</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<pre><code>## The following object is masked from &#39;package:graphics&#39;:
## 
##     layout</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myinterplot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(ozone, <span class="kw">aes</span>(T12, maxO3)) +<span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">text =</span> <span class="kw">paste</span>(<span class="st">&quot;wind:&quot;</span>, wind)), <span class="dt">size =</span> <span class="fl">0.8</span>) +<span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="kw">aes</span>(<span class="dt">color=</span>rain)) +<span class="st"> </span><span class="kw">facet_wrap</span>(~rain)</code></pre></div>
<pre><code>## Warning: Ignoring unknown aesthetics: text</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplotly</span>(myinterplot)</code></pre></div>
<pre><code>## We recommend that you use the dev version of ggplot2 with `ggplotly()`
## Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`</code></pre>
<div id="51ac6f912471" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="51ac6f912471">{"x":{"data":[{"x":[18.5,18.4,17.6,19.7,20.5,15.6,17.5,19.6,21.9,19.3,20.3,19.6,17.4,19.1,24.6,22.4,24.2,28.6,25.2,32.7,23.5,22.9,25.1,23.4,22.7,28.4,30.1,18.8,23.7,22,20.7,21,20.4,19.1,21.6,21.9,22.5,22.5,26.9,27.7,28.3,27.6,29.6,30.5,26.3,29.5,23,20,25.2,20.5,29.8,23.7,24.8,28.4,27.2,33.5,22.9,26.3,24.4,18.6,19.8,22.2,17.7,18,19.7,17.6,17.7,23,18.6],"y":[87,82,92,114,94,79,79,101,106,101,90,72,83,88,145,81,121,146,121,146,108,83,81,67,70,106,139,79,97,88,77,71,84,92,66,72,81,83,149,153,159,149,160,156,84,126,65,77,111,75,116,109,113,131,166,159,100,114,112,76,63,78,71,71,98,92,84,99,70],"text":["wind: North<br />T12: 18.5<br />maxO3:  87","wind: North<br />T12: 18.4<br />maxO3:  82","wind: East<br />T12: 17.6<br />maxO3:  92","wind: North<br />T12: 19.7<br />maxO3: 114","wind: West<br />T12: 20.5<br />maxO3:  94","wind: West<br />T12: 15.6<br />maxO3:  79","wind: North<br />T12: 17.5<br />maxO3:  79","wind: North<br />T12: 19.6<br />maxO3: 101","wind: West<br />T12: 21.9<br />maxO3: 106","wind: North<br />T12: 19.3<br />maxO3: 101","wind: South<br />T12: 20.3<br />maxO3:  90","wind: South<br />T12: 19.6<br />maxO3:  72","wind: North<br />T12: 17.4<br />maxO3:  83","wind: West<br />T12: 19.1<br />maxO3:  88","wind: West<br />T12: 24.6<br />maxO3: 145","wind: North<br />T12: 22.4<br />maxO3:  81","wind: East<br />T12: 24.2<br />maxO3: 121","wind: South<br />T12: 28.6<br />maxO3: 146","wind: North<br />T12: 25.2<br />maxO3: 121","wind: East<br />T12: 32.7<br />maxO3: 146","wind: South<br />T12: 23.5<br />maxO3: 108","wind: West<br />T12: 22.9<br />maxO3:  83","wind: South<br />T12: 25.1<br />maxO3:  81","wind: West<br />T12: 23.4<br />maxO3:  67","wind: North<br />T12: 22.7<br />maxO3:  70","wind: East<br />T12: 28.4<br />maxO3: 106","wind: South<br />T12: 30.1<br />maxO3: 139","wind: West<br />T12: 18.8<br />maxO3:  79","wind: North<br />T12: 23.7<br />maxO3:  97","wind: West<br />T12: 22.0<br />maxO3:  88","wind: West<br />T12: 20.7<br />maxO3:  77","wind: West<br />T12: 21.0<br />maxO3:  71","wind: South<br />T12: 20.4<br />maxO3:  84","wind: North<br />T12: 19.1<br />maxO3:  92","wind: South<br />T12: 21.6<br />maxO3:  66","wind: West<br />T12: 21.9<br />maxO3:  72","wind: North<br />T12: 22.5<br />maxO3:  81","wind: North<br />T12: 22.5<br />maxO3:  83","wind: West<br />T12: 26.9<br />maxO3: 149","wind: North<br />T12: 27.7<br />maxO3: 153","wind: North<br />T12: 28.3<br />maxO3: 159","wind: West<br />T12: 27.6<br />maxO3: 149","wind: South<br />T12: 29.6<br />maxO3: 160","wind: West<br />T12: 30.5<br />maxO3: 156","wind: North<br />T12: 26.3<br />maxO3:  84","wind: East<br />T12: 29.5<br />maxO3: 126","wind: West<br />T12: 23.0<br />maxO3:  65","wind: North<br />T12: 20.0<br />maxO3:  77","wind: West<br />T12: 25.2<br />maxO3: 111","wind: North<br />T12: 20.5<br />maxO3:  75","wind: South<br />T12: 29.8<br />maxO3: 116","wind: South<br />T12: 23.7<br />maxO3: 109","wind: South<br />T12: 24.8<br />maxO3: 113","wind: West<br />T12: 28.4<br />maxO3: 131","wind: West<br />T12: 27.2<br />maxO3: 166","wind: South<br />T12: 33.5<br />maxO3: 159","wind: West<br />T12: 22.9<br />maxO3: 100","wind: East<br />T12: 26.3<br />maxO3: 114","wind: East<br />T12: 24.4<br />maxO3: 112","wind: West<br />T12: 18.6<br />maxO3:  76","wind: West<br />T12: 19.8<br />maxO3:  63","wind: West<br />T12: 22.2<br />maxO3:  78","wind: North<br />T12: 17.7<br />maxO3:  71","wind: West<br />T12: 18.0<br />maxO3:  71","wind: East<br />T12: 19.7<br />maxO3:  98","wind: North<br />T12: 17.6<br />maxO3:  92","wind: South<br />T12: 17.7<br />maxO3:  84","wind: South<br />T12: 23.0<br />maxO3:  99","wind: South<br />T12: 18.6<br />maxO3:  70"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":3.02362204724409,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[19.8,18.2,22.4,18.2,18.2,21.2,17.3,14.5,18.6,19.1,20.5,15.6,20.3,23.8,18.2,20.6,18.7,21.6,21.4,17.1,22.8,21.1,21.3,26.9,17.8,20.3,20.2,22.7,16.8,19.2,18.9,18.3,20.8,18.7,17.9,17.7,14,14.3,16.3,19.4,17.7,20.8,19.8],"y":[80,70,57,93,113,72,56,45,67,67,63,69,88,116,77,63,54,72,60,70,98,67,76,117,101,59,78,76,55,71,66,59,68,74,71,69,60,42,65,96,76,77,83],"text":["wind: West<br />T12: 19.8<br />maxO3:  80","wind: West<br />T12: 18.2<br />maxO3:  70","wind: West<br />T12: 22.4<br />maxO3:  57","wind: South<br />T12: 18.2<br />maxO3:  93","wind: West<br />T12: 18.2<br />maxO3: 113","wind: West<br />T12: 21.2<br />maxO3:  72","wind: West<br />T12: 17.3<br />maxO3:  56","wind: East<br />T12: 14.5<br />maxO3:  45","wind: West<br />T12: 18.6<br />maxO3:  67","wind: West<br />T12: 19.1<br />maxO3:  67","wind: West<br />T12: 20.5<br />maxO3:  63","wind: West<br />T12: 15.6<br />maxO3:  69","wind: West<br />T12: 20.3<br />maxO3:  88","wind: South<br />T12: 23.8<br />maxO3: 116","wind: West<br />T12: 18.2<br />maxO3:  77","wind: West<br />T12: 20.6<br />maxO3:  63","wind: South<br />T12: 18.7<br />maxO3:  54","wind: West<br />T12: 21.6<br />maxO3:  72","wind: West<br />T12: 21.4<br />maxO3:  60","wind: North<br />T12: 17.1<br />maxO3:  70","wind: West<br />T12: 22.8<br />maxO3:  98","wind: West<br />T12: 21.1<br />maxO3:  67","wind: West<br />T12: 21.3<br />maxO3:  76","wind: South<br />T12: 26.9<br />maxO3: 117","wind: North<br />T12: 17.8<br />maxO3: 101","wind: West<br />T12: 20.3<br />maxO3:  59","wind: North<br />T12: 20.2<br />maxO3:  78","wind: West<br />T12: 22.7<br />maxO3:  76","wind: West<br />T12: 16.8<br />maxO3:  55","wind: North<br />T12: 19.2<br />maxO3:  71","wind: North<br />T12: 18.9<br />maxO3:  66","wind: North<br />T12: 18.3<br />maxO3:  59","wind: West<br />T12: 20.8<br />maxO3:  68","wind: West<br />T12: 18.7<br />maxO3:  74","wind: North<br />T12: 17.9<br />maxO3:  71","wind: North<br />T12: 17.7<br />maxO3:  69","wind: North<br />T12: 14.0<br />maxO3:  60","wind: North<br />T12: 14.3<br />maxO3:  42","wind: West<br />T12: 16.3<br />maxO3:  65","wind: East<br />T12: 19.4<br />maxO3:  96","wind: West<br />T12: 17.7<br />maxO3:  76","wind: South<br />T12: 20.8<br />maxO3:  77","wind: West<br />T12: 19.8<br />maxO3:  83"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":3.02362204724409,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[15.6,15.826582278481,16.053164556962,16.279746835443,16.506329113924,16.7329113924051,16.9594936708861,17.1860759493671,17.4126582278481,17.6392405063291,17.8658227848101,18.0924050632911,18.3189873417722,18.5455696202532,18.7721518987342,18.9987341772152,19.2253164556962,19.4518987341772,19.6784810126582,19.9050632911392,20.1316455696203,20.3582278481013,20.5848101265823,20.8113924050633,21.0379746835443,21.2645569620253,21.4911392405063,21.7177215189873,21.9443037974684,22.1708860759494,22.3974683544304,22.6240506329114,22.8506329113924,23.0772151898734,23.3037974683544,23.5303797468354,23.7569620253165,23.9835443037975,24.2101265822785,24.4367088607595,24.6632911392405,24.8898734177215,25.1164556962025,25.3430379746835,25.5696202531646,25.7962025316456,26.0227848101266,26.2493670886076,26.4759493670886,26.7025316455696,26.9291139240506,27.1556962025316,27.3822784810127,27.6088607594937,27.8354430379747,28.0620253164557,28.2886075949367,28.5151898734177,28.7417721518987,28.9683544303797,29.1949367088608,29.4215189873418,29.6481012658228,29.8746835443038,30.1012658227848,30.3278481012658,30.5544303797468,30.7810126582278,31.0075949367089,31.2341772151899,31.4607594936709,31.6873417721519,31.9139240506329,32.1405063291139,32.3670886075949,32.5936708860759,32.820253164557,33.046835443038,33.273417721519,33.5],"y":[61.8177492468326,63.0244142921287,64.2310793374249,65.437744382721,66.6444094280172,67.8510744733134,69.0577395186095,70.2644045639056,71.4710696092018,72.677734654498,73.8843996997941,75.0910647450903,76.2977297903864,77.5043948356825,78.7110598809787,79.9177249262749,81.124389971571,82.3310550168671,83.5377200621633,84.7443851074595,85.9510501527556,87.1577151980518,88.3643802433479,89.5710452886441,90.7777103339402,91.9843753792364,93.1910404245325,94.3977054698287,95.6043705151248,96.811035560421,98.0177006057171,99.2243656510133,100.431030696309,101.637695741606,102.844360786902,104.051025832198,105.257690877494,106.46435592279,107.671020968086,108.877686013382,110.084351058679,111.291016103975,112.497681149271,113.704346194567,114.911011239863,116.117676285159,117.324341330456,118.531006375752,119.737671421048,120.944336466344,122.15100151164,123.357666556936,124.564331602232,125.770996647529,126.977661692825,128.184326738121,129.390991783417,130.597656828713,131.804321874009,133.010986919306,134.217651964602,135.424317009898,136.630982055194,137.83764710049,139.044312145786,140.250977191082,141.457642236379,142.664307281675,143.870972326971,145.077637372267,146.284302417563,147.490967462859,148.697632508155,149.904297553452,151.110962598748,152.317627644044,153.52429268934,154.730957734636,155.937622779932,157.144287825229],"text":["rain: Dry<br />T12: 15.60000<br />maxO3:  61.81775","rain: Dry<br />T12: 15.82658<br />maxO3:  63.02441","rain: Dry<br />T12: 16.05316<br />maxO3:  64.23108","rain: Dry<br />T12: 16.27975<br />maxO3:  65.43774","rain: Dry<br />T12: 16.50633<br />maxO3:  66.64441","rain: Dry<br />T12: 16.73291<br />maxO3:  67.85107","rain: Dry<br />T12: 16.95949<br />maxO3:  69.05774","rain: Dry<br />T12: 17.18608<br />maxO3:  70.26440","rain: Dry<br />T12: 17.41266<br />maxO3:  71.47107","rain: Dry<br />T12: 17.63924<br />maxO3:  72.67773","rain: Dry<br />T12: 17.86582<br />maxO3:  73.88440","rain: Dry<br />T12: 18.09241<br />maxO3:  75.09106","rain: Dry<br />T12: 18.31899<br />maxO3:  76.29773","rain: Dry<br />T12: 18.54557<br />maxO3:  77.50439","rain: Dry<br />T12: 18.77215<br />maxO3:  78.71106","rain: Dry<br />T12: 18.99873<br />maxO3:  79.91772","rain: Dry<br />T12: 19.22532<br />maxO3:  81.12439","rain: Dry<br />T12: 19.45190<br />maxO3:  82.33106","rain: Dry<br />T12: 19.67848<br />maxO3:  83.53772","rain: Dry<br />T12: 19.90506<br />maxO3:  84.74439","rain: Dry<br />T12: 20.13165<br />maxO3:  85.95105","rain: Dry<br />T12: 20.35823<br />maxO3:  87.15772","rain: Dry<br />T12: 20.58481<br />maxO3:  88.36438","rain: Dry<br />T12: 20.81139<br />maxO3:  89.57105","rain: Dry<br />T12: 21.03797<br />maxO3:  90.77771","rain: Dry<br />T12: 21.26456<br />maxO3:  91.98438","rain: Dry<br />T12: 21.49114<br />maxO3:  93.19104","rain: Dry<br />T12: 21.71772<br />maxO3:  94.39771","rain: Dry<br />T12: 21.94430<br />maxO3:  95.60437","rain: Dry<br />T12: 22.17089<br />maxO3:  96.81104","rain: Dry<br />T12: 22.39747<br />maxO3:  98.01770","rain: Dry<br />T12: 22.62405<br />maxO3:  99.22437","rain: Dry<br />T12: 22.85063<br />maxO3: 100.43103","rain: Dry<br />T12: 23.07722<br />maxO3: 101.63770","rain: Dry<br />T12: 23.30380<br />maxO3: 102.84436","rain: Dry<br />T12: 23.53038<br />maxO3: 104.05103","rain: Dry<br />T12: 23.75696<br />maxO3: 105.25769","rain: Dry<br />T12: 23.98354<br />maxO3: 106.46436","rain: Dry<br />T12: 24.21013<br />maxO3: 107.67102","rain: Dry<br />T12: 24.43671<br />maxO3: 108.87769","rain: Dry<br />T12: 24.66329<br />maxO3: 110.08435","rain: Dry<br />T12: 24.88987<br />maxO3: 111.29102","rain: Dry<br />T12: 25.11646<br />maxO3: 112.49768","rain: Dry<br />T12: 25.34304<br />maxO3: 113.70435","rain: Dry<br />T12: 25.56962<br />maxO3: 114.91101","rain: Dry<br />T12: 25.79620<br />maxO3: 116.11768","rain: Dry<br />T12: 26.02278<br />maxO3: 117.32434","rain: Dry<br />T12: 26.24937<br />maxO3: 118.53101","rain: Dry<br />T12: 26.47595<br />maxO3: 119.73767","rain: Dry<br />T12: 26.70253<br />maxO3: 120.94434","rain: Dry<br />T12: 26.92911<br />maxO3: 122.15100","rain: Dry<br />T12: 27.15570<br />maxO3: 123.35767","rain: Dry<br />T12: 27.38228<br />maxO3: 124.56433","rain: Dry<br />T12: 27.60886<br />maxO3: 125.77100","rain: Dry<br />T12: 27.83544<br />maxO3: 126.97766","rain: Dry<br />T12: 28.06203<br />maxO3: 128.18433","rain: Dry<br />T12: 28.28861<br />maxO3: 129.39099","rain: Dry<br />T12: 28.51519<br />maxO3: 130.59766","rain: Dry<br />T12: 28.74177<br />maxO3: 131.80432","rain: Dry<br />T12: 28.96835<br />maxO3: 133.01099","rain: Dry<br />T12: 29.19494<br />maxO3: 134.21765","rain: Dry<br />T12: 29.42152<br />maxO3: 135.42432","rain: Dry<br />T12: 29.64810<br />maxO3: 136.63098","rain: Dry<br />T12: 29.87468<br />maxO3: 137.83765","rain: Dry<br />T12: 30.10127<br />maxO3: 139.04431","rain: Dry<br />T12: 30.32785<br />maxO3: 140.25098","rain: Dry<br />T12: 30.55443<br />maxO3: 141.45764","rain: Dry<br />T12: 30.78101<br />maxO3: 142.66431","rain: Dry<br />T12: 31.00759<br />maxO3: 143.87097","rain: Dry<br />T12: 31.23418<br />maxO3: 145.07764","rain: Dry<br />T12: 31.46076<br />maxO3: 146.28430","rain: Dry<br />T12: 31.68734<br />maxO3: 147.49097","rain: Dry<br />T12: 31.91392<br />maxO3: 148.69763","rain: Dry<br />T12: 32.14051<br />maxO3: 149.90430","rain: Dry<br />T12: 32.36709<br />maxO3: 151.11096","rain: Dry<br />T12: 32.59367<br />maxO3: 152.31763","rain: Dry<br />T12: 32.82025<br />maxO3: 153.52429","rain: Dry<br />T12: 33.04684<br />maxO3: 154.73096","rain: Dry<br />T12: 33.27342<br />maxO3: 155.93762","rain: Dry<br />T12: 33.50000<br />maxO3: 157.14429"],"type":"scatter","mode":"lines","name":"Dry","line":{"width":3.77952755905512,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","legendgroup":"Dry","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[14,14.1632911392405,14.326582278481,14.4898734177215,14.653164556962,14.8164556962025,14.979746835443,15.1430379746835,15.3063291139241,15.4696202531646,15.6329113924051,15.7962025316456,15.9594936708861,16.1227848101266,16.2860759493671,16.4493670886076,16.6126582278481,16.7759493670886,16.9392405063291,17.1025316455696,17.2658227848101,17.4291139240506,17.5924050632911,17.7556962025316,17.9189873417722,18.0822784810127,18.2455696202532,18.4088607594937,18.5721518987342,18.7354430379747,18.8987341772152,19.0620253164557,19.2253164556962,19.3886075949367,19.5518987341772,19.7151898734177,19.8784810126582,20.0417721518987,20.2050632911392,20.3683544303797,20.5316455696203,20.6949367088608,20.8582278481013,21.0215189873418,21.1848101265823,21.3481012658228,21.5113924050633,21.6746835443038,21.8379746835443,22.0012658227848,22.1645569620253,22.3278481012658,22.4911392405063,22.6544303797468,22.8177215189873,22.9810126582278,23.1443037974684,23.3075949367089,23.4708860759494,23.6341772151899,23.7974683544304,23.9607594936709,24.1240506329114,24.2873417721519,24.4506329113924,24.6139240506329,24.7772151898734,24.9405063291139,25.1037974683544,25.2670886075949,25.4303797468354,25.5936708860759,25.7569620253165,25.920253164557,26.0835443037975,26.246835443038,26.4101265822785,26.573417721519,26.7367088607595,26.9],"y":[55.2252812868939,55.7873142133513,56.3493471398087,56.911380066266,57.4734129927234,58.0354459191808,58.5974788456381,59.1595117720955,59.7215446985529,60.2835776250102,60.8456105514676,61.407643477925,61.9696764043823,62.5317093308397,63.0937422572971,63.6557751837544,64.2178081102118,64.7798410366692,65.3418739631265,65.9039068895839,66.4659398160412,67.0279727424986,67.590005668956,68.1520385954133,68.7140715218707,69.2761044483281,69.8381373747854,70.4001703012428,70.9622032277002,71.5242361541575,72.0862690806149,72.6483020070723,73.2103349335296,73.772367859987,74.3344007864444,74.8964337129017,75.4584666393591,76.0204995658165,76.5825324922738,77.1445654187312,77.7065983451886,78.2686312716459,78.8306641981033,79.3926971245607,79.954730051018,80.5167629774754,81.0787959039328,81.6408288303901,82.2028617568475,82.7648946833049,83.3269276097622,83.8889605362196,84.4509934626769,85.0130263891343,85.5750593155917,86.1370922420491,86.6991251685064,87.2611580949638,87.8231910214212,88.3852239478785,88.9472568743359,89.5092898007932,90.0713227272506,90.633355653708,91.1953885801653,91.7574215066227,92.3194544330801,92.8814873595374,93.4435202859948,94.0055532124522,94.5675861389095,95.1296190653669,95.6916519918243,96.2536849182816,96.815717844739,97.3777507711964,97.9397836976537,98.5018166241111,99.0638495505685,99.6258824770258],"text":["rain: Rainy<br />T12: 14.00000<br />maxO3:  55.22528","rain: Rainy<br />T12: 14.16329<br />maxO3:  55.78731","rain: Rainy<br />T12: 14.32658<br />maxO3:  56.34935","rain: Rainy<br />T12: 14.48987<br />maxO3:  56.91138","rain: Rainy<br />T12: 14.65316<br />maxO3:  57.47341","rain: Rainy<br />T12: 14.81646<br />maxO3:  58.03545","rain: Rainy<br />T12: 14.97975<br />maxO3:  58.59748","rain: Rainy<br />T12: 15.14304<br />maxO3:  59.15951","rain: Rainy<br />T12: 15.30633<br />maxO3:  59.72154","rain: Rainy<br />T12: 15.46962<br />maxO3:  60.28358","rain: Rainy<br />T12: 15.63291<br />maxO3:  60.84561","rain: Rainy<br />T12: 15.79620<br />maxO3:  61.40764","rain: Rainy<br />T12: 15.95949<br />maxO3:  61.96968","rain: Rainy<br />T12: 16.12278<br />maxO3:  62.53171","rain: Rainy<br />T12: 16.28608<br />maxO3:  63.09374","rain: Rainy<br />T12: 16.44937<br />maxO3:  63.65578","rain: Rainy<br />T12: 16.61266<br />maxO3:  64.21781","rain: Rainy<br />T12: 16.77595<br />maxO3:  64.77984","rain: Rainy<br />T12: 16.93924<br />maxO3:  65.34187","rain: Rainy<br />T12: 17.10253<br />maxO3:  65.90391","rain: Rainy<br />T12: 17.26582<br />maxO3:  66.46594","rain: Rainy<br />T12: 17.42911<br />maxO3:  67.02797","rain: Rainy<br />T12: 17.59241<br />maxO3:  67.59001","rain: Rainy<br />T12: 17.75570<br />maxO3:  68.15204","rain: Rainy<br />T12: 17.91899<br />maxO3:  68.71407","rain: Rainy<br />T12: 18.08228<br />maxO3:  69.27610","rain: Rainy<br />T12: 18.24557<br />maxO3:  69.83814","rain: Rainy<br />T12: 18.40886<br />maxO3:  70.40017","rain: Rainy<br />T12: 18.57215<br />maxO3:  70.96220","rain: Rainy<br />T12: 18.73544<br />maxO3:  71.52424","rain: Rainy<br />T12: 18.89873<br />maxO3:  72.08627","rain: Rainy<br />T12: 19.06203<br />maxO3:  72.64830","rain: Rainy<br />T12: 19.22532<br />maxO3:  73.21033","rain: Rainy<br />T12: 19.38861<br />maxO3:  73.77237","rain: Rainy<br />T12: 19.55190<br />maxO3:  74.33440","rain: Rainy<br />T12: 19.71519<br />maxO3:  74.89643","rain: Rainy<br />T12: 19.87848<br />maxO3:  75.45847","rain: Rainy<br />T12: 20.04177<br />maxO3:  76.02050","rain: Rainy<br />T12: 20.20506<br />maxO3:  76.58253","rain: Rainy<br />T12: 20.36835<br />maxO3:  77.14457","rain: Rainy<br />T12: 20.53165<br />maxO3:  77.70660","rain: Rainy<br />T12: 20.69494<br />maxO3:  78.26863","rain: Rainy<br />T12: 20.85823<br />maxO3:  78.83066","rain: Rainy<br />T12: 21.02152<br />maxO3:  79.39270","rain: Rainy<br />T12: 21.18481<br />maxO3:  79.95473","rain: Rainy<br />T12: 21.34810<br />maxO3:  80.51676","rain: Rainy<br />T12: 21.51139<br />maxO3:  81.07880","rain: Rainy<br />T12: 21.67468<br />maxO3:  81.64083","rain: Rainy<br />T12: 21.83797<br />maxO3:  82.20286","rain: Rainy<br />T12: 22.00127<br />maxO3:  82.76489","rain: Rainy<br />T12: 22.16456<br />maxO3:  83.32693","rain: Rainy<br />T12: 22.32785<br />maxO3:  83.88896","rain: Rainy<br />T12: 22.49114<br />maxO3:  84.45099","rain: Rainy<br />T12: 22.65443<br />maxO3:  85.01303","rain: Rainy<br />T12: 22.81772<br />maxO3:  85.57506","rain: Rainy<br />T12: 22.98101<br />maxO3:  86.13709","rain: Rainy<br />T12: 23.14430<br />maxO3:  86.69913","rain: Rainy<br />T12: 23.30759<br />maxO3:  87.26116","rain: Rainy<br />T12: 23.47089<br />maxO3:  87.82319","rain: Rainy<br />T12: 23.63418<br />maxO3:  88.38522","rain: Rainy<br />T12: 23.79747<br />maxO3:  88.94726","rain: Rainy<br />T12: 23.96076<br />maxO3:  89.50929","rain: Rainy<br />T12: 24.12405<br />maxO3:  90.07132","rain: Rainy<br />T12: 24.28734<br />maxO3:  90.63336","rain: Rainy<br />T12: 24.45063<br />maxO3:  91.19539","rain: Rainy<br />T12: 24.61392<br />maxO3:  91.75742","rain: Rainy<br />T12: 24.77722<br />maxO3:  92.31945","rain: Rainy<br />T12: 24.94051<br />maxO3:  92.88149","rain: Rainy<br />T12: 25.10380<br />maxO3:  93.44352","rain: Rainy<br />T12: 25.26709<br />maxO3:  94.00555","rain: Rainy<br />T12: 25.43038<br />maxO3:  94.56759","rain: Rainy<br />T12: 25.59367<br />maxO3:  95.12962","rain: Rainy<br />T12: 25.75696<br />maxO3:  95.69165","rain: Rainy<br />T12: 25.92025<br />maxO3:  96.25368","rain: Rainy<br />T12: 26.08354<br />maxO3:  96.81572","rain: Rainy<br />T12: 26.24684<br />maxO3:  97.37775","rain: Rainy<br />T12: 26.41013<br />maxO3:  97.93978","rain: Rainy<br />T12: 26.57342<br />maxO3:  98.50182","rain: Rainy<br />T12: 26.73671<br />maxO3:  99.06385","rain: Rainy<br />T12: 26.90000<br />maxO3:  99.62588"],"type":"scatter","mode":"lines","name":"Rainy","line":{"width":3.77952755905512,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","legendgroup":"Rainy","showlegend":true,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[15.6,15.826582278481,16.053164556962,16.279746835443,16.506329113924,16.7329113924051,16.9594936708861,17.1860759493671,17.4126582278481,17.6392405063291,17.8658227848101,18.0924050632911,18.3189873417722,18.5455696202532,18.7721518987342,18.9987341772152,19.2253164556962,19.4518987341772,19.6784810126582,19.9050632911392,20.1316455696203,20.3582278481013,20.5848101265823,20.8113924050633,21.0379746835443,21.2645569620253,21.4911392405063,21.7177215189873,21.9443037974684,22.1708860759494,22.3974683544304,22.6240506329114,22.8506329113924,23.0772151898734,23.3037974683544,23.5303797468354,23.7569620253165,23.9835443037975,24.2101265822785,24.4367088607595,24.6632911392405,24.8898734177215,25.1164556962025,25.3430379746835,25.5696202531646,25.7962025316456,26.0227848101266,26.2493670886076,26.4759493670886,26.7025316455696,26.9291139240506,27.1556962025316,27.3822784810127,27.6088607594937,27.8354430379747,28.0620253164557,28.2886075949367,28.5151898734177,28.7417721518987,28.9683544303797,29.1949367088608,29.4215189873418,29.6481012658228,29.8746835443038,30.1012658227848,30.3278481012658,30.5544303797468,30.7810126582278,31.0075949367089,31.2341772151899,31.4607594936709,31.6873417721519,31.9139240506329,32.1405063291139,32.3670886075949,32.5936708860759,32.820253164557,33.046835443038,33.273417721519,33.5,33.5,33.5,33.273417721519,33.046835443038,32.820253164557,32.5936708860759,32.3670886075949,32.1405063291139,31.9139240506329,31.6873417721519,31.4607594936709,31.2341772151899,31.0075949367089,30.7810126582278,30.5544303797468,30.3278481012658,30.1012658227848,29.8746835443038,29.6481012658228,29.4215189873418,29.1949367088608,28.9683544303797,28.7417721518987,28.5151898734177,28.2886075949367,28.0620253164557,27.8354430379747,27.6088607594937,27.3822784810127,27.1556962025316,26.9291139240506,26.7025316455696,26.4759493670886,26.2493670886076,26.0227848101266,25.7962025316456,25.5696202531646,25.3430379746835,25.1164556962025,24.8898734177215,24.6632911392405,24.4367088607595,24.2101265822785,23.9835443037975,23.7569620253165,23.5303797468354,23.3037974683544,23.0772151898734,22.8506329113924,22.6240506329114,22.3974683544304,22.1708860759494,21.9443037974684,21.7177215189873,21.4911392405063,21.2645569620253,21.0379746835443,20.8113924050633,20.5848101265823,20.3582278481013,20.1316455696203,19.9050632911392,19.6784810126582,19.4518987341772,19.2253164556962,18.9987341772152,18.7721518987342,18.5455696202532,18.3189873417722,18.0924050632911,17.8658227848101,17.6392405063291,17.4126582278481,17.1860759493671,16.9594936708861,16.7329113924051,16.506329113924,16.279746835443,16.053164556962,15.826582278481,15.6,15.6],"y":[52.9472271892119,54.3607993848887,55.7726971126639,57.18279548086,58.5909581307469,59.9970360766885,61.4008664370707,62.8022710519057,64.2010549855565,65.5970049168153,66.9898874239928,68.3794471802084,69.76540508426,71.1474563659243,72.5252687219353,73.8984805608009,75.2666994614583,76.6295009825513,77.9864279951607,79.3369907503692,80.6806679307529,82.0169089663507,83.3451379129982,84.6647591837949,85.9751653807428,87.2757473810493,88.5659066820204,89.8450697980533,91.112704243383,92.3683353514863,93.6115629195778,94.8420764792505,96.0596679369784,97.2642404399743,98.455812611246,99.6345177298936,100.800597939449,101.954394059092,103.096331964599,104.226906739085,105.346665848492,106.45619249226,107.556090061884,108.646968365446,109.72943199691,110.80407098287,111.87145364786,112.932121507987,113.986585927079,115.035326238871,116.078789040818,117.117388387959,118.151506649482,119.181495829106,120.20767918839,121.230353046935,122.249788663632,123.266234128354,124.279916213916,125.291042154158,126.29980132638,127.306366825619,128.31089692506,129.313536421722,130.314417869904,131.313662707119,132.31138227859,133.307678767162,134.302646035778,135.296370389721,136.288931265577,137.280401853598,138.270849659687,139.260337012837,140.248921523323,141.236656496566,142.22359130707,143.209771736475,144.195240279341,145.180036419931,145.180036419931,169.108539230526,167.680005280524,166.252143732798,164.82499407161,163.398598791522,161.973003674172,160.548258094067,159.124415356624,157.701533072121,156.279673569549,154.858904354813,153.439298618163,152.020935796187,150.603902194167,149.188291675046,147.774206421669,146.361757779258,144.951067185327,143.542267194177,142.135502602823,140.730931684453,139.328727534102,137.929079529072,136.532194903202,135.138300429306,133.74764419726,132.360497465951,130.977156554982,129.597944725914,128.223213982462,126.853346693817,125.488756915017,124.129891243516,122.777229013051,121.431281587449,120.092590482817,118.761724023688,117.439272236658,116.125839715689,114.822036268865,113.52846528768,112.245709971574,110.974317786488,109.714783815539,108.467533934502,107.232908962557,106.011151043237,104.80239345564,103.606654822776,102.423838291856,101.253735769356,100.096036786867,98.950341141604,97.8161741670447,96.6930033774234,95.5802552871376,94.4773313934932,93.3836225736976,92.2985214297528,91.2214323747583,90.1517794645498,89.0890121291659,88.032609051183,86.9820804816837,85.9369692917488,84.8968510400221,83.8613333054408,82.8300544965128,81.8026823099721,80.7789119755954,79.7584643921806,78.7410842328471,77.7265380759056,76.7146126001482,75.7051128699382,74.6978607252875,73.6926932845821,72.6894615621859,71.6880291993688,70.6882713044533,52.9472271892119],"text":["rain: Dry<br />T12: 15.60000<br />maxO3:  61.81775","rain: Dry<br />T12: 15.82658<br />maxO3:  63.02441","rain: Dry<br />T12: 16.05316<br />maxO3:  64.23108","rain: Dry<br />T12: 16.27975<br />maxO3:  65.43774","rain: Dry<br />T12: 16.50633<br />maxO3:  66.64441","rain: Dry<br />T12: 16.73291<br />maxO3:  67.85107","rain: Dry<br />T12: 16.95949<br />maxO3:  69.05774","rain: Dry<br />T12: 17.18608<br />maxO3:  70.26440","rain: Dry<br />T12: 17.41266<br />maxO3:  71.47107","rain: Dry<br />T12: 17.63924<br />maxO3:  72.67773","rain: Dry<br />T12: 17.86582<br />maxO3:  73.88440","rain: Dry<br />T12: 18.09241<br />maxO3:  75.09106","rain: Dry<br />T12: 18.31899<br />maxO3:  76.29773","rain: Dry<br />T12: 18.54557<br />maxO3:  77.50439","rain: Dry<br />T12: 18.77215<br />maxO3:  78.71106","rain: Dry<br />T12: 18.99873<br />maxO3:  79.91772","rain: Dry<br />T12: 19.22532<br />maxO3:  81.12439","rain: Dry<br />T12: 19.45190<br />maxO3:  82.33106","rain: Dry<br />T12: 19.67848<br />maxO3:  83.53772","rain: Dry<br />T12: 19.90506<br />maxO3:  84.74439","rain: Dry<br />T12: 20.13165<br />maxO3:  85.95105","rain: Dry<br />T12: 20.35823<br />maxO3:  87.15772","rain: Dry<br />T12: 20.58481<br />maxO3:  88.36438","rain: Dry<br />T12: 20.81139<br />maxO3:  89.57105","rain: Dry<br />T12: 21.03797<br />maxO3:  90.77771","rain: Dry<br />T12: 21.26456<br />maxO3:  91.98438","rain: Dry<br />T12: 21.49114<br />maxO3:  93.19104","rain: Dry<br />T12: 21.71772<br />maxO3:  94.39771","rain: Dry<br />T12: 21.94430<br />maxO3:  95.60437","rain: Dry<br />T12: 22.17089<br />maxO3:  96.81104","rain: Dry<br />T12: 22.39747<br />maxO3:  98.01770","rain: Dry<br />T12: 22.62405<br />maxO3:  99.22437","rain: Dry<br />T12: 22.85063<br />maxO3: 100.43103","rain: Dry<br />T12: 23.07722<br />maxO3: 101.63770","rain: Dry<br />T12: 23.30380<br />maxO3: 102.84436","rain: Dry<br />T12: 23.53038<br />maxO3: 104.05103","rain: Dry<br />T12: 23.75696<br />maxO3: 105.25769","rain: Dry<br />T12: 23.98354<br />maxO3: 106.46436","rain: Dry<br />T12: 24.21013<br />maxO3: 107.67102","rain: Dry<br />T12: 24.43671<br />maxO3: 108.87769","rain: Dry<br />T12: 24.66329<br />maxO3: 110.08435","rain: Dry<br />T12: 24.88987<br />maxO3: 111.29102","rain: Dry<br />T12: 25.11646<br />maxO3: 112.49768","rain: Dry<br />T12: 25.34304<br />maxO3: 113.70435","rain: Dry<br />T12: 25.56962<br />maxO3: 114.91101","rain: Dry<br />T12: 25.79620<br />maxO3: 116.11768","rain: Dry<br />T12: 26.02278<br />maxO3: 117.32434","rain: Dry<br />T12: 26.24937<br />maxO3: 118.53101","rain: Dry<br />T12: 26.47595<br />maxO3: 119.73767","rain: Dry<br />T12: 26.70253<br />maxO3: 120.94434","rain: Dry<br />T12: 26.92911<br />maxO3: 122.15100","rain: Dry<br />T12: 27.15570<br />maxO3: 123.35767","rain: Dry<br />T12: 27.38228<br />maxO3: 124.56433","rain: Dry<br />T12: 27.60886<br />maxO3: 125.77100","rain: Dry<br />T12: 27.83544<br />maxO3: 126.97766","rain: Dry<br />T12: 28.06203<br />maxO3: 128.18433","rain: Dry<br />T12: 28.28861<br />maxO3: 129.39099","rain: Dry<br />T12: 28.51519<br />maxO3: 130.59766","rain: Dry<br />T12: 28.74177<br />maxO3: 131.80432","rain: Dry<br />T12: 28.96835<br />maxO3: 133.01099","rain: Dry<br />T12: 29.19494<br />maxO3: 134.21765","rain: Dry<br />T12: 29.42152<br />maxO3: 135.42432","rain: Dry<br />T12: 29.64810<br />maxO3: 136.63098","rain: Dry<br />T12: 29.87468<br />maxO3: 137.83765","rain: Dry<br />T12: 30.10127<br />maxO3: 139.04431","rain: Dry<br />T12: 30.32785<br />maxO3: 140.25098","rain: Dry<br />T12: 30.55443<br />maxO3: 141.45764","rain: Dry<br />T12: 30.78101<br />maxO3: 142.66431","rain: Dry<br />T12: 31.00759<br />maxO3: 143.87097","rain: Dry<br />T12: 31.23418<br />maxO3: 145.07764","rain: Dry<br />T12: 31.46076<br />maxO3: 146.28430","rain: Dry<br />T12: 31.68734<br />maxO3: 147.49097","rain: Dry<br />T12: 31.91392<br />maxO3: 148.69763","rain: Dry<br />T12: 32.14051<br />maxO3: 149.90430","rain: Dry<br />T12: 32.36709<br />maxO3: 151.11096","rain: Dry<br />T12: 32.59367<br />maxO3: 152.31763","rain: Dry<br />T12: 32.82025<br />maxO3: 153.52429","rain: Dry<br />T12: 33.04684<br />maxO3: 154.73096","rain: Dry<br />T12: 33.27342<br />maxO3: 155.93762","rain: Dry<br />T12: 33.50000<br />maxO3: 157.14429","rain: Dry<br />T12: 33.50000<br />maxO3: 157.14429","rain: Dry<br />T12: 33.50000<br />maxO3: 157.14429","rain: Dry<br />T12: 33.27342<br />maxO3: 155.93762","rain: Dry<br />T12: 33.04684<br />maxO3: 154.73096","rain: Dry<br />T12: 32.82025<br />maxO3: 153.52429","rain: Dry<br />T12: 32.59367<br />maxO3: 152.31763","rain: Dry<br />T12: 32.36709<br />maxO3: 151.11096","rain: Dry<br />T12: 32.14051<br />maxO3: 149.90430","rain: Dry<br />T12: 31.91392<br />maxO3: 148.69763","rain: Dry<br />T12: 31.68734<br />maxO3: 147.49097","rain: Dry<br />T12: 31.46076<br />maxO3: 146.28430","rain: Dry<br />T12: 31.23418<br />maxO3: 145.07764","rain: Dry<br />T12: 31.00759<br />maxO3: 143.87097","rain: Dry<br />T12: 30.78101<br />maxO3: 142.66431","rain: Dry<br />T12: 30.55443<br />maxO3: 141.45764","rain: Dry<br />T12: 30.32785<br />maxO3: 140.25098","rain: Dry<br />T12: 30.10127<br />maxO3: 139.04431","rain: Dry<br />T12: 29.87468<br />maxO3: 137.83765","rain: Dry<br />T12: 29.64810<br />maxO3: 136.63098","rain: Dry<br />T12: 29.42152<br />maxO3: 135.42432","rain: Dry<br />T12: 29.19494<br />maxO3: 134.21765","rain: Dry<br />T12: 28.96835<br />maxO3: 133.01099","rain: Dry<br />T12: 28.74177<br />maxO3: 131.80432","rain: Dry<br />T12: 28.51519<br />maxO3: 130.59766","rain: Dry<br />T12: 28.28861<br />maxO3: 129.39099","rain: Dry<br />T12: 28.06203<br />maxO3: 128.18433","rain: Dry<br />T12: 27.83544<br />maxO3: 126.97766","rain: Dry<br />T12: 27.60886<br />maxO3: 125.77100","rain: Dry<br />T12: 27.38228<br />maxO3: 124.56433","rain: Dry<br />T12: 27.15570<br />maxO3: 123.35767","rain: Dry<br />T12: 26.92911<br />maxO3: 122.15100","rain: Dry<br />T12: 26.70253<br />maxO3: 120.94434","rain: Dry<br />T12: 26.47595<br />maxO3: 119.73767","rain: Dry<br />T12: 26.24937<br />maxO3: 118.53101","rain: Dry<br />T12: 26.02278<br />maxO3: 117.32434","rain: Dry<br />T12: 25.79620<br />maxO3: 116.11768","rain: Dry<br />T12: 25.56962<br />maxO3: 114.91101","rain: Dry<br />T12: 25.34304<br />maxO3: 113.70435","rain: Dry<br />T12: 25.11646<br />maxO3: 112.49768","rain: Dry<br />T12: 24.88987<br />maxO3: 111.29102","rain: Dry<br />T12: 24.66329<br />maxO3: 110.08435","rain: Dry<br />T12: 24.43671<br />maxO3: 108.87769","rain: Dry<br />T12: 24.21013<br />maxO3: 107.67102","rain: Dry<br />T12: 23.98354<br />maxO3: 106.46436","rain: Dry<br />T12: 23.75696<br />maxO3: 105.25769","rain: Dry<br />T12: 23.53038<br />maxO3: 104.05103","rain: Dry<br />T12: 23.30380<br />maxO3: 102.84436","rain: Dry<br />T12: 23.07722<br />maxO3: 101.63770","rain: Dry<br />T12: 22.85063<br />maxO3: 100.43103","rain: Dry<br />T12: 22.62405<br />maxO3:  99.22437","rain: Dry<br />T12: 22.39747<br />maxO3:  98.01770","rain: Dry<br />T12: 22.17089<br />maxO3:  96.81104","rain: Dry<br />T12: 21.94430<br />maxO3:  95.60437","rain: Dry<br />T12: 21.71772<br />maxO3:  94.39771","rain: Dry<br />T12: 21.49114<br />maxO3:  93.19104","rain: Dry<br />T12: 21.26456<br />maxO3:  91.98438","rain: Dry<br />T12: 21.03797<br />maxO3:  90.77771","rain: Dry<br />T12: 20.81139<br />maxO3:  89.57105","rain: Dry<br />T12: 20.58481<br />maxO3:  88.36438","rain: Dry<br />T12: 20.35823<br />maxO3:  87.15772","rain: Dry<br />T12: 20.13165<br />maxO3:  85.95105","rain: Dry<br />T12: 19.90506<br />maxO3:  84.74439","rain: Dry<br />T12: 19.67848<br />maxO3:  83.53772","rain: Dry<br />T12: 19.45190<br />maxO3:  82.33106","rain: Dry<br />T12: 19.22532<br />maxO3:  81.12439","rain: Dry<br />T12: 18.99873<br />maxO3:  79.91772","rain: Dry<br />T12: 18.77215<br />maxO3:  78.71106","rain: Dry<br />T12: 18.54557<br />maxO3:  77.50439","rain: Dry<br />T12: 18.31899<br />maxO3:  76.29773","rain: Dry<br />T12: 18.09241<br />maxO3:  75.09106","rain: Dry<br />T12: 17.86582<br />maxO3:  73.88440","rain: Dry<br />T12: 17.63924<br />maxO3:  72.67773","rain: Dry<br />T12: 17.41266<br />maxO3:  71.47107","rain: Dry<br />T12: 17.18608<br />maxO3:  70.26440","rain: Dry<br />T12: 16.95949<br />maxO3:  69.05774","rain: Dry<br />T12: 16.73291<br />maxO3:  67.85107","rain: Dry<br />T12: 16.50633<br />maxO3:  66.64441","rain: Dry<br />T12: 16.27975<br />maxO3:  65.43774","rain: Dry<br />T12: 16.05316<br />maxO3:  64.23108","rain: Dry<br />T12: 15.82658<br />maxO3:  63.02441","rain: Dry<br />T12: 15.60000<br />maxO3:  61.81775","rain: Dry<br />T12: 15.60000<br />maxO3:  61.81775"],"type":"scatter","mode":"lines","line":{"width":3.77952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(153,153,153,0.4)","hoveron":"points","hoverinfo":"x+y","name":"Dry","legendgroup":"Dry","showlegend":false,"xaxis":"x","yaxis":"y","frame":null},{"x":[14,14.1632911392405,14.326582278481,14.4898734177215,14.653164556962,14.8164556962025,14.979746835443,15.1430379746835,15.3063291139241,15.4696202531646,15.6329113924051,15.7962025316456,15.9594936708861,16.1227848101266,16.2860759493671,16.4493670886076,16.6126582278481,16.7759493670886,16.9392405063291,17.1025316455696,17.2658227848101,17.4291139240506,17.5924050632911,17.7556962025316,17.9189873417722,18.0822784810127,18.2455696202532,18.4088607594937,18.5721518987342,18.7354430379747,18.8987341772152,19.0620253164557,19.2253164556962,19.3886075949367,19.5518987341772,19.7151898734177,19.8784810126582,20.0417721518987,20.2050632911392,20.3683544303797,20.5316455696203,20.6949367088608,20.8582278481013,21.0215189873418,21.1848101265823,21.3481012658228,21.5113924050633,21.6746835443038,21.8379746835443,22.0012658227848,22.1645569620253,22.3278481012658,22.4911392405063,22.6544303797468,22.8177215189873,22.9810126582278,23.1443037974684,23.3075949367089,23.4708860759494,23.6341772151899,23.7974683544304,23.9607594936709,24.1240506329114,24.2873417721519,24.4506329113924,24.6139240506329,24.7772151898734,24.9405063291139,25.1037974683544,25.2670886075949,25.4303797468354,25.5936708860759,25.7569620253165,25.920253164557,26.0835443037975,26.246835443038,26.4101265822785,26.573417721519,26.7367088607595,26.9,26.9,26.7367088607595,26.573417721519,26.4101265822785,26.246835443038,26.0835443037975,25.920253164557,25.7569620253165,25.5936708860759,25.4303797468354,25.2670886075949,25.1037974683544,24.9405063291139,24.7772151898734,24.6139240506329,24.4506329113924,24.2873417721519,24.1240506329114,23.9607594936709,23.7974683544304,23.6341772151899,23.4708860759494,23.3075949367089,23.1443037974684,22.9810126582278,22.8177215189873,22.6544303797468,22.4911392405063,22.3278481012658,22.1645569620253,22.0012658227848,21.8379746835443,21.6746835443038,21.5113924050633,21.3481012658228,21.1848101265823,21.0215189873418,20.8582278481013,20.6949367088608,20.5316455696203,20.3683544303797,20.2050632911392,20.0417721518987,19.8784810126582,19.7151898734177,19.5518987341772,19.3886075949367,19.2253164556962,19.0620253164557,18.8987341772152,18.7354430379747,18.5721518987342,18.4088607594937,18.2455696202532,18.0822784810127,17.9189873417722,17.7556962025316,17.5924050632911,17.4291139240506,17.2658227848101,17.1025316455696,16.9392405063291,16.7759493670886,16.6126582278481,16.4493670886076,16.2860759493671,16.1227848101266,15.9594936708861,15.7962025316456,15.6329113924051,15.4696202531646,15.3063291139241,15.1430379746835,14.979746835443,14.8164556962025,14.653164556962,14.4898734177215,14.326582278481,14.1632911392405,14,14],"y":[44.5523866928377,45.382430138337,46.210805483643,47.0373777412814,47.8619980285015,48.6845019018204,49.5047074794473,50.3224133274415,51.1373960847495,51.9494078026529,52.7581729762776,53.5633852505353,54.3647037914128,55.1617493275061,55.9540998882334,56.7412862969173,57.5227875221231,58.2980260528593,59.0663635460827,59.8270971011192,60.5794566455389,61.3226040665314,62.0556348789311,62.7775833620966,63.4874321839171,64.1841275057414,64.8666003590028,65.533794635983,66.1847013038658,66.8183974563565,67.4340876817575,68.0311441814505,68.6091414246454,69.1678811647766,69.7074045202677,70.2279894464754,70.7301339532088,71.2145273630485,71.6820133016868,72.13354869939,72.570162860692,72.9929198398154,73.4028862514505,73.8011055385213,74.188578804941,74.5662516867646,74.9350063771187,75.2956577862514,75.6489528385274,75.9955720184759,76.3361324280843,76.6711917740295,77.0012528472329,77.3267681791196,77.6481446569548,77.9657479560531,78.279906702644,78.5909163213897,78.899042549482,79.2045246179325,79.5075781125771,79.8083975343982,80.1071585824828,80.4040201843716,80.6991262985127,80.9926075125522,81.2845824596814,81.5751590734696,81.8644356997226,82.1525020820289,82.4394402358672,82.7253252244741,83.0102258481443,83.2942052572504,83.5773214980349,83.8596279991231,84.1411740057342,84.4220049677111,84.702162886735,84.9816866274327,114.270078326619,113.425536214402,112.581628280511,111.738393389573,110.89587354327,110.054114191443,109.213164579313,108.373078135504,107.53391290626,106.695732041952,105.858604342875,105.022604872267,104.187815645605,103.354326406479,102.522235500693,101.691650861818,100.862691123044,100.035486872018,99.2101820671882,98.3869356360947,97.5659232778245,96.7473394933603,95.9313998685379,95.1183436343688,94.308436528045,93.5019739742286,92.699284599149,91.900734078121,91.1067292984097,90.3177227914401,89.5342173481338,88.7567706751676,87.9859998745289,87.2225854307468,86.4672742681862,85.720881297095,84.9842887106001,84.2584421447561,83.5443427034764,82.8430338296852,82.1555821380724,81.4830516828608,80.8264717685844,80.1867993255094,79.564877979328,78.961397052621,78.3768545551974,77.8115284424139,77.2654598326941,76.7384504794723,76.2300748519586,75.7397051515345,75.2665459665026,74.8096743905681,74.3680813909148,73.9407108598243,73.5264938287301,73.1243764589809,72.7333414184658,72.3524229865436,71.9807166780486,71.6173843801703,71.261656020479,70.9128286983005,70.5702640705916,70.2333846263608,69.9016693341733,69.5746490173519,69.2519017053146,68.9330481266576,68.6177474473676,68.3056933123563,67.9966102167495,67.690250211829,67.3863899365412,67.0848279569453,66.7853823912507,66.4878887959744,66.1921982883656,65.8981758809502,44.5523866928377],"text":["rain: Rainy<br />T12: 14.00000<br />maxO3:  55.22528","rain: Rainy<br />T12: 14.16329<br />maxO3:  55.78731","rain: Rainy<br />T12: 14.32658<br />maxO3:  56.34935","rain: Rainy<br />T12: 14.48987<br />maxO3:  56.91138","rain: Rainy<br />T12: 14.65316<br />maxO3:  57.47341","rain: Rainy<br />T12: 14.81646<br />maxO3:  58.03545","rain: Rainy<br />T12: 14.97975<br />maxO3:  58.59748","rain: Rainy<br />T12: 15.14304<br />maxO3:  59.15951","rain: Rainy<br />T12: 15.30633<br />maxO3:  59.72154","rain: Rainy<br />T12: 15.46962<br />maxO3:  60.28358","rain: Rainy<br />T12: 15.63291<br />maxO3:  60.84561","rain: Rainy<br />T12: 15.79620<br />maxO3:  61.40764","rain: Rainy<br />T12: 15.95949<br />maxO3:  61.96968","rain: Rainy<br />T12: 16.12278<br />maxO3:  62.53171","rain: Rainy<br />T12: 16.28608<br />maxO3:  63.09374","rain: Rainy<br />T12: 16.44937<br />maxO3:  63.65578","rain: Rainy<br />T12: 16.61266<br />maxO3:  64.21781","rain: Rainy<br />T12: 16.77595<br />maxO3:  64.77984","rain: Rainy<br />T12: 16.93924<br />maxO3:  65.34187","rain: Rainy<br />T12: 17.10253<br />maxO3:  65.90391","rain: Rainy<br />T12: 17.26582<br />maxO3:  66.46594","rain: Rainy<br />T12: 17.42911<br />maxO3:  67.02797","rain: Rainy<br />T12: 17.59241<br />maxO3:  67.59001","rain: Rainy<br />T12: 17.75570<br />maxO3:  68.15204","rain: Rainy<br />T12: 17.91899<br />maxO3:  68.71407","rain: Rainy<br />T12: 18.08228<br />maxO3:  69.27610","rain: Rainy<br />T12: 18.24557<br />maxO3:  69.83814","rain: Rainy<br />T12: 18.40886<br />maxO3:  70.40017","rain: Rainy<br />T12: 18.57215<br />maxO3:  70.96220","rain: Rainy<br />T12: 18.73544<br />maxO3:  71.52424","rain: Rainy<br />T12: 18.89873<br />maxO3:  72.08627","rain: Rainy<br />T12: 19.06203<br />maxO3:  72.64830","rain: Rainy<br />T12: 19.22532<br />maxO3:  73.21033","rain: Rainy<br />T12: 19.38861<br />maxO3:  73.77237","rain: Rainy<br />T12: 19.55190<br />maxO3:  74.33440","rain: Rainy<br />T12: 19.71519<br />maxO3:  74.89643","rain: Rainy<br />T12: 19.87848<br />maxO3:  75.45847","rain: Rainy<br />T12: 20.04177<br />maxO3:  76.02050","rain: Rainy<br />T12: 20.20506<br />maxO3:  76.58253","rain: Rainy<br />T12: 20.36835<br />maxO3:  77.14457","rain: Rainy<br />T12: 20.53165<br />maxO3:  77.70660","rain: Rainy<br />T12: 20.69494<br />maxO3:  78.26863","rain: Rainy<br />T12: 20.85823<br />maxO3:  78.83066","rain: Rainy<br />T12: 21.02152<br />maxO3:  79.39270","rain: Rainy<br />T12: 21.18481<br />maxO3:  79.95473","rain: Rainy<br />T12: 21.34810<br />maxO3:  80.51676","rain: Rainy<br />T12: 21.51139<br />maxO3:  81.07880","rain: Rainy<br />T12: 21.67468<br />maxO3:  81.64083","rain: Rainy<br />T12: 21.83797<br />maxO3:  82.20286","rain: Rainy<br />T12: 22.00127<br />maxO3:  82.76489","rain: Rainy<br />T12: 22.16456<br />maxO3:  83.32693","rain: Rainy<br />T12: 22.32785<br />maxO3:  83.88896","rain: Rainy<br />T12: 22.49114<br />maxO3:  84.45099","rain: Rainy<br />T12: 22.65443<br />maxO3:  85.01303","rain: Rainy<br />T12: 22.81772<br />maxO3:  85.57506","rain: Rainy<br />T12: 22.98101<br />maxO3:  86.13709","rain: Rainy<br />T12: 23.14430<br />maxO3:  86.69913","rain: Rainy<br />T12: 23.30759<br />maxO3:  87.26116","rain: Rainy<br />T12: 23.47089<br />maxO3:  87.82319","rain: Rainy<br />T12: 23.63418<br />maxO3:  88.38522","rain: Rainy<br />T12: 23.79747<br />maxO3:  88.94726","rain: Rainy<br />T12: 23.96076<br />maxO3:  89.50929","rain: Rainy<br />T12: 24.12405<br />maxO3:  90.07132","rain: Rainy<br />T12: 24.28734<br />maxO3:  90.63336","rain: Rainy<br />T12: 24.45063<br />maxO3:  91.19539","rain: Rainy<br />T12: 24.61392<br />maxO3:  91.75742","rain: Rainy<br />T12: 24.77722<br />maxO3:  92.31945","rain: Rainy<br />T12: 24.94051<br />maxO3:  92.88149","rain: Rainy<br />T12: 25.10380<br />maxO3:  93.44352","rain: Rainy<br />T12: 25.26709<br />maxO3:  94.00555","rain: Rainy<br />T12: 25.43038<br />maxO3:  94.56759","rain: Rainy<br />T12: 25.59367<br />maxO3:  95.12962","rain: Rainy<br />T12: 25.75696<br />maxO3:  95.69165","rain: Rainy<br />T12: 25.92025<br />maxO3:  96.25368","rain: Rainy<br />T12: 26.08354<br />maxO3:  96.81572","rain: Rainy<br />T12: 26.24684<br />maxO3:  97.37775","rain: Rainy<br />T12: 26.41013<br />maxO3:  97.93978","rain: Rainy<br />T12: 26.57342<br />maxO3:  98.50182","rain: Rainy<br />T12: 26.73671<br />maxO3:  99.06385","rain: Rainy<br />T12: 26.90000<br />maxO3:  99.62588","rain: Rainy<br />T12: 26.90000<br />maxO3:  99.62588","rain: Rainy<br />T12: 26.73671<br />maxO3:  99.06385","rain: Rainy<br />T12: 26.57342<br />maxO3:  98.50182","rain: Rainy<br />T12: 26.41013<br />maxO3:  97.93978","rain: Rainy<br />T12: 26.24684<br />maxO3:  97.37775","rain: Rainy<br />T12: 26.08354<br />maxO3:  96.81572","rain: Rainy<br />T12: 25.92025<br />maxO3:  96.25368","rain: Rainy<br />T12: 25.75696<br />maxO3:  95.69165","rain: Rainy<br />T12: 25.59367<br />maxO3:  95.12962","rain: Rainy<br />T12: 25.43038<br />maxO3:  94.56759","rain: Rainy<br />T12: 25.26709<br />maxO3:  94.00555","rain: Rainy<br />T12: 25.10380<br />maxO3:  93.44352","rain: Rainy<br />T12: 24.94051<br />maxO3:  92.88149","rain: Rainy<br />T12: 24.77722<br />maxO3:  92.31945","rain: Rainy<br />T12: 24.61392<br />maxO3:  91.75742","rain: Rainy<br />T12: 24.45063<br />maxO3:  91.19539","rain: Rainy<br />T12: 24.28734<br />maxO3:  90.63336","rain: Rainy<br />T12: 24.12405<br />maxO3:  90.07132","rain: Rainy<br />T12: 23.96076<br />maxO3:  89.50929","rain: Rainy<br />T12: 23.79747<br />maxO3:  88.94726","rain: Rainy<br />T12: 23.63418<br />maxO3:  88.38522","rain: Rainy<br />T12: 23.47089<br />maxO3:  87.82319","rain: Rainy<br />T12: 23.30759<br />maxO3:  87.26116","rain: Rainy<br />T12: 23.14430<br />maxO3:  86.69913","rain: Rainy<br />T12: 22.98101<br />maxO3:  86.13709","rain: Rainy<br />T12: 22.81772<br />maxO3:  85.57506","rain: Rainy<br />T12: 22.65443<br />maxO3:  85.01303","rain: Rainy<br />T12: 22.49114<br />maxO3:  84.45099","rain: Rainy<br />T12: 22.32785<br />maxO3:  83.88896","rain: Rainy<br />T12: 22.16456<br />maxO3:  83.32693","rain: Rainy<br />T12: 22.00127<br />maxO3:  82.76489","rain: Rainy<br />T12: 21.83797<br />maxO3:  82.20286","rain: Rainy<br />T12: 21.67468<br />maxO3:  81.64083","rain: Rainy<br />T12: 21.51139<br />maxO3:  81.07880","rain: Rainy<br />T12: 21.34810<br />maxO3:  80.51676","rain: Rainy<br />T12: 21.18481<br />maxO3:  79.95473","rain: Rainy<br />T12: 21.02152<br />maxO3:  79.39270","rain: Rainy<br />T12: 20.85823<br />maxO3:  78.83066","rain: Rainy<br />T12: 20.69494<br />maxO3:  78.26863","rain: Rainy<br />T12: 20.53165<br />maxO3:  77.70660","rain: Rainy<br />T12: 20.36835<br />maxO3:  77.14457","rain: Rainy<br />T12: 20.20506<br />maxO3:  76.58253","rain: Rainy<br />T12: 20.04177<br />maxO3:  76.02050","rain: Rainy<br />T12: 19.87848<br />maxO3:  75.45847","rain: Rainy<br />T12: 19.71519<br />maxO3:  74.89643","rain: Rainy<br />T12: 19.55190<br />maxO3:  74.33440","rain: Rainy<br />T12: 19.38861<br />maxO3:  73.77237","rain: Rainy<br />T12: 19.22532<br />maxO3:  73.21033","rain: Rainy<br />T12: 19.06203<br />maxO3:  72.64830","rain: Rainy<br />T12: 18.89873<br />maxO3:  72.08627","rain: Rainy<br />T12: 18.73544<br />maxO3:  71.52424","rain: Rainy<br />T12: 18.57215<br />maxO3:  70.96220","rain: Rainy<br />T12: 18.40886<br />maxO3:  70.40017","rain: Rainy<br />T12: 18.24557<br />maxO3:  69.83814","rain: Rainy<br />T12: 18.08228<br />maxO3:  69.27610","rain: Rainy<br />T12: 17.91899<br />maxO3:  68.71407","rain: Rainy<br />T12: 17.75570<br />maxO3:  68.15204","rain: Rainy<br />T12: 17.59241<br />maxO3:  67.59001","rain: Rainy<br />T12: 17.42911<br />maxO3:  67.02797","rain: Rainy<br />T12: 17.26582<br />maxO3:  66.46594","rain: Rainy<br />T12: 17.10253<br />maxO3:  65.90391","rain: Rainy<br />T12: 16.93924<br />maxO3:  65.34187","rain: Rainy<br />T12: 16.77595<br />maxO3:  64.77984","rain: Rainy<br />T12: 16.61266<br />maxO3:  64.21781","rain: Rainy<br />T12: 16.44937<br />maxO3:  63.65578","rain: Rainy<br />T12: 16.28608<br />maxO3:  63.09374","rain: Rainy<br />T12: 16.12278<br />maxO3:  62.53171","rain: Rainy<br />T12: 15.95949<br />maxO3:  61.96968","rain: Rainy<br />T12: 15.79620<br />maxO3:  61.40764","rain: Rainy<br />T12: 15.63291<br />maxO3:  60.84561","rain: Rainy<br />T12: 15.46962<br />maxO3:  60.28358","rain: Rainy<br />T12: 15.30633<br />maxO3:  59.72154","rain: Rainy<br />T12: 15.14304<br />maxO3:  59.15951","rain: Rainy<br />T12: 14.97975<br />maxO3:  58.59748","rain: Rainy<br />T12: 14.81646<br />maxO3:  58.03545","rain: Rainy<br />T12: 14.65316<br />maxO3:  57.47341","rain: Rainy<br />T12: 14.48987<br />maxO3:  56.91138","rain: Rainy<br />T12: 14.32658<br />maxO3:  56.34935","rain: Rainy<br />T12: 14.16329<br />maxO3:  55.78731","rain: Rainy<br />T12: 14.00000<br />maxO3:  55.22528","rain: Rainy<br />T12: 14.00000<br />maxO3:  55.22528"],"type":"scatter","mode":"lines","line":{"width":3.77952755905512,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(153,153,153,0.4)","hoveron":"points","hoverinfo":"x+y","name":"Rainy","legendgroup":"Rainy","showlegend":false,"xaxis":"x2","yaxis":"y","frame":null}],"layout":{"margin":{"t":37.9178082191781,"r":7.30593607305936,"b":40.1826484018265,"l":43.1050228310502},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,0.489128071319852],"type":"linear","autorange":false,"tickmode":"array","range":[13.025,34.475],"ticktext":["15","20","25","30"],"tickvals":[15,20,25,30],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"annotations":[{"text":"T12","x":0.5,"y":-0.0471841704718417,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"top","annotationType":"axis"},{"text":"maxO3","x":-0.0424005218525767,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-90,"xanchor":"right","yanchor":"center","annotationType":"axis"},{"text":"Dry","x":0.244564035659926,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"Rainy","x":0.755435964340074,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"rain","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"yaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[35.6445730384737,175.463966192052],"ticktext":["60","90","120","150"],"tickvals":[60,90,120,150],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.489128071319852,"y0":0,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.489128071319852,"y0":1,"y1":1.06929133858268},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.510871928680148,"x1":1,"y0":0,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.510871928680148,"x1":1,"y0":1,"y1":1.06929133858268}],"xaxis2":{"type":"linear","autorange":false,"tickmode":"array","range":[13.025,34.475],"ticktext":["15","20","25","30"],"tickvals":[15,20,25,30],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.510871928680148,1],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":0.913385826771654},"hovermode":"closest"},"source":"A","attrs":{"51ac236b2c3d":{"text":{},"x":{},"y":{},"type":"ggplotly"},"51ac51256af5":{"colour":{},"x":{},"y":{}}},"cur_data":"51ac236b2c3d","visdat":{"51ac236b2c3d":["function (y) ","x"],"51ac51256af5":["function (y) ","x"]},"config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bb &lt;-<span class="st"> </span><span class="kw">ggplot</span>(ozone, <span class="kw">aes</span> (T12, maxO3)) +<span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Ne12))
<span class="kw">ggplotly</span>(bb)</code></pre></div>
<pre><code>## We recommend that you use the dev version of ggplot2 with `ggplotly()`
## Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`</code></pre>
<div id="51ac622133a" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="51ac622133a">{"x":{"data":[{"x":[18.5,18.4,17.6,19.7,20.5,19.8,15.6,17.5,19.6,21.9,19.3,20.3,19.6,18.2,17.4,19.1,24.6,22.4,24.2,28.6,25.2,32.7,23.5,22.9,22.4,25.1,23.4,22.7,28.4,30.1,18.8,18.2,23.7,18.2,21.2,22,20.7,21,17.3,14.5,18.6,19.1,20.4,20.5,15.6,19.1,20.3,21.6,21.9,22.5,22.5,26.9,27.7,28.3,27.6,29.6,30.5,26.3,29.5,23.8,18.2,20.6,18.7,23,21.6,21.4,17.1,20,22.8,25.2,20.5,29.8,23.7,21.1,21.3,24.8,26.9,28.4,27.2,33.5,22.9,26.3,24.4,17.8,18.6,20.3,20.2,22.7,16.8,19.2,18.9,18.3,20.8,19.8,22.2,18.7,17.9,17.7,17.7,14,14.3,16.3,18,19.4,19.7,17.6,17.7,17.7,20.8,23,19.8,18.6],"y":[87,82,92,114,94,80,79,79,101,106,101,90,72,70,83,88,145,81,121,146,121,146,108,83,57,81,67,70,106,139,79,93,97,113,72,88,77,71,56,45,67,67,84,63,69,92,88,66,72,81,83,149,153,159,149,160,156,84,126,116,77,63,54,65,72,60,70,77,98,111,75,116,109,67,76,113,117,131,166,159,100,114,112,101,76,59,78,76,55,71,66,59,68,63,78,74,71,69,71,60,42,65,71,96,98,92,76,84,77,99,83,70],"text":["Ne12: 4<br />T12: 18.5<br />maxO3:  87","Ne12: 5<br />T12: 18.4<br />maxO3:  82","Ne12: 5<br />T12: 17.6<br />maxO3:  92","Ne12: 1<br />T12: 19.7<br />maxO3: 114","Ne12: 8<br />T12: 20.5<br />maxO3:  94","Ne12: 6<br />T12: 19.8<br />maxO3:  80","Ne12: 8<br />T12: 15.6<br />maxO3:  79","Ne12: 5<br />T12: 17.5<br />maxO3:  79","Ne12: 4<br />T12: 19.6<br />maxO3: 101","Ne12: 6<br />T12: 21.9<br />maxO3: 106","Ne12: 7<br />T12: 19.3<br />maxO3: 101","Ne12: 6<br />T12: 20.3<br />maxO3:  90","Ne12: 5<br />T12: 19.6<br />maxO3:  72","Ne12: 7<br />T12: 18.2<br />maxO3:  70","Ne12: 7<br />T12: 17.4<br />maxO3:  83","Ne12: 5<br />T12: 19.1<br />maxO3:  88","Ne12: 1<br />T12: 24.6<br />maxO3: 145","Ne12: 3<br />T12: 22.4<br />maxO3:  81","Ne12: 1<br />T12: 24.2<br />maxO3: 121","Ne12: 1<br />T12: 28.6<br />maxO3: 146","Ne12: 0<br />T12: 25.2<br />maxO3: 121","Ne12: 0<br />T12: 32.7<br />maxO3: 146","Ne12: 4<br />T12: 23.5<br />maxO3: 108","Ne12: 6<br />T12: 22.9<br />maxO3:  83","Ne12: 6<br />T12: 22.4<br />maxO3:  57","Ne12: 4<br />T12: 25.1<br />maxO3:  81","Ne12: 5<br />T12: 23.4<br />maxO3:  67","Ne12: 2<br />T12: 22.7<br />maxO3:  70","Ne12: 0<br />T12: 28.4<br />maxO3: 106","Ne12: 1<br />T12: 30.1<br />maxO3: 139","Ne12: 8<br />T12: 18.8<br />maxO3:  79","Ne12: 8<br />T12: 18.2<br />maxO3:  93","Ne12: 3<br />T12: 23.7<br />maxO3:  97","Ne12: 8<br />T12: 18.2<br />maxO3: 113","Ne12: 6<br />T12: 21.2<br />maxO3:  72","Ne12: 7<br />T12: 22.0<br />maxO3:  88","Ne12: 8<br />T12: 20.7<br />maxO3:  77","Ne12: 4<br />T12: 21.0<br />maxO3:  71","Ne12: 8<br />T12: 17.3<br />maxO3:  56","Ne12: 8<br />T12: 14.5<br />maxO3:  45","Ne12: 7<br />T12: 18.6<br />maxO3:  67","Ne12: 5<br />T12: 19.1<br />maxO3:  67","Ne12: 4<br />T12: 20.4<br />maxO3:  84","Ne12: 6<br />T12: 20.5<br />maxO3:  63","Ne12: 8<br />T12: 15.6<br />maxO3:  69","Ne12: 6<br />T12: 19.1<br />maxO3:  92","Ne12: 6<br />T12: 20.3<br />maxO3:  88","Ne12: 6<br />T12: 21.6<br />maxO3:  66","Ne12: 7<br />T12: 21.9<br />maxO3:  72","Ne12: 3<br />T12: 22.5<br />maxO3:  81","Ne12: 4<br />T12: 22.5<br />maxO3:  83","Ne12: 4<br />T12: 26.9<br />maxO3: 149","Ne12: 1<br />T12: 27.7<br />maxO3: 153","Ne12: 2<br />T12: 28.3<br />maxO3: 159","Ne12: 6<br />T12: 27.6<br />maxO3: 149","Ne12: 3<br />T12: 29.6<br />maxO3: 160","Ne12: 1<br />T12: 30.5<br />maxO3: 156","Ne12: 0<br />T12: 26.3<br />maxO3:  84","Ne12: 4<br />T12: 29.5<br />maxO3: 126","Ne12: 7<br />T12: 23.8<br />maxO3: 116","Ne12: 7<br />T12: 18.2<br />maxO3:  77","Ne12: 7<br />T12: 20.6<br />maxO3:  63","Ne12: 8<br />T12: 18.7<br />maxO3:  54","Ne12: 7<br />T12: 23.0<br />maxO3:  65","Ne12: 7<br />T12: 21.6<br />maxO3:  72","Ne12: 7<br />T12: 21.4<br />maxO3:  60","Ne12: 6<br />T12: 17.1<br />maxO3:  70","Ne12: 5<br />T12: 20.0<br />maxO3:  77","Ne12: 1<br />T12: 22.8<br />maxO3:  98","Ne12: 5<br />T12: 25.2<br />maxO3: 111","Ne12: 7<br />T12: 20.5<br />maxO3:  75","Ne12: 3<br />T12: 29.8<br />maxO3: 116","Ne12: 5<br />T12: 23.7<br />maxO3: 109","Ne12: 7<br />T12: 21.1<br />maxO3:  67","Ne12: 5<br />T12: 21.3<br />maxO3:  76","Ne12: 1<br />T12: 24.8<br />maxO3: 113","Ne12: 6<br />T12: 26.9<br />maxO3: 117","Ne12: 3<br />T12: 28.4<br />maxO3: 131","Ne12: 0<br />T12: 27.2<br />maxO3: 166","Ne12: 1<br />T12: 33.5<br />maxO3: 159","Ne12: 8<br />T12: 22.9<br />maxO3: 100","Ne12: 4<br />T12: 26.3<br />maxO3: 114","Ne12: 6<br />T12: 24.4<br />maxO3: 112","Ne12: 7<br />T12: 17.8<br />maxO3: 101","Ne12: 7<br />T12: 18.6<br />maxO3:  76","Ne12: 7<br />T12: 20.3<br />maxO3:  59","Ne12: 5<br />T12: 20.2<br />maxO3:  78","Ne12: 5<br />T12: 22.7<br />maxO3:  76","Ne12: 7<br />T12: 16.8<br />maxO3:  55","Ne12: 5<br />T12: 19.2<br />maxO3:  71","Ne12: 5<br />T12: 18.9<br />maxO3:  66","Ne12: 7<br />T12: 18.3<br />maxO3:  59","Ne12: 5<br />T12: 20.8<br />maxO3:  68","Ne12: 8<br />T12: 19.8<br />maxO3:  63","Ne12: 5<br />T12: 22.2<br />maxO3:  78","Ne12: 7<br />T12: 18.7<br />maxO3:  74","Ne12: 5<br />T12: 17.9<br />maxO3:  71","Ne12: 7<br />T12: 17.7<br />maxO3:  69","Ne12: 5<br />T12: 17.7<br />maxO3:  71","Ne12: 5<br />T12: 14.0<br />maxO3:  60","Ne12: 7<br />T12: 14.3<br />maxO3:  42","Ne12: 7<br />T12: 16.3<br />maxO3:  65","Ne12: 7<br />T12: 18.0<br />maxO3:  71","Ne12: 3<br />T12: 19.4<br />maxO3:  96","Ne12: 2<br />T12: 19.7<br />maxO3:  98","Ne12: 4<br />T12: 17.6<br />maxO3:  92","Ne12: 7<br />T12: 17.7<br />maxO3:  76","Ne12: 5<br />T12: 17.7<br />maxO3:  84","Ne12: 5<br />T12: 20.8<br />maxO3:  77","Ne12: 4<br />T12: 23.0<br />maxO3:  99","Ne12: 5<br />T12: 19.8<br />maxO3:  83","Ne12: 7<br />T12: 18.6<br />maxO3:  70"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":["rgba(51,106,152,1)","rgba(59,123,175,1)","rgba(59,123,175,1)","rgba(27,58,87,1)","rgba(86,177,247,1)","rgba(68,141,198,1)","rgba(86,177,247,1)","rgba(59,123,175,1)","rgba(51,106,152,1)","rgba(68,141,198,1)","rgba(77,159,222,1)","rgba(68,141,198,1)","rgba(59,123,175,1)","rgba(77,159,222,1)","rgba(77,159,222,1)","rgba(59,123,175,1)","rgba(27,58,87,1)","rgba(42,90,130,1)","rgba(27,58,87,1)","rgba(27,58,87,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(51,106,152,1)","rgba(68,141,198,1)","rgba(68,141,198,1)","rgba(51,106,152,1)","rgba(59,123,175,1)","rgba(34,73,108,1)","rgba(19,43,67,1)","rgba(27,58,87,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(42,90,130,1)","rgba(86,177,247,1)","rgba(68,141,198,1)","rgba(77,159,222,1)","rgba(86,177,247,1)","rgba(51,106,152,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(77,159,222,1)","rgba(59,123,175,1)","rgba(51,106,152,1)","rgba(68,141,198,1)","rgba(86,177,247,1)","rgba(68,141,198,1)","rgba(68,141,198,1)","rgba(68,141,198,1)","rgba(77,159,222,1)","rgba(42,90,130,1)","rgba(51,106,152,1)","rgba(51,106,152,1)","rgba(27,58,87,1)","rgba(34,73,108,1)","rgba(68,141,198,1)","rgba(42,90,130,1)","rgba(27,58,87,1)","rgba(19,43,67,1)","rgba(51,106,152,1)","rgba(77,159,222,1)","rgba(77,159,222,1)","rgba(77,159,222,1)","rgba(86,177,247,1)","rgba(77,159,222,1)","rgba(77,159,222,1)","rgba(77,159,222,1)","rgba(68,141,198,1)","rgba(59,123,175,1)","rgba(27,58,87,1)","rgba(59,123,175,1)","rgba(77,159,222,1)","rgba(42,90,130,1)","rgba(59,123,175,1)","rgba(77,159,222,1)","rgba(59,123,175,1)","rgba(27,58,87,1)","rgba(68,141,198,1)","rgba(42,90,130,1)","rgba(19,43,67,1)","rgba(27,58,87,1)","rgba(86,177,247,1)","rgba(51,106,152,1)","rgba(68,141,198,1)","rgba(77,159,222,1)","rgba(77,159,222,1)","rgba(77,159,222,1)","rgba(59,123,175,1)","rgba(59,123,175,1)","rgba(77,159,222,1)","rgba(59,123,175,1)","rgba(59,123,175,1)","rgba(77,159,222,1)","rgba(59,123,175,1)","rgba(86,177,247,1)","rgba(59,123,175,1)","rgba(77,159,222,1)","rgba(59,123,175,1)","rgba(77,159,222,1)","rgba(59,123,175,1)","rgba(59,123,175,1)","rgba(77,159,222,1)","rgba(77,159,222,1)","rgba(77,159,222,1)","rgba(42,90,130,1)","rgba(34,73,108,1)","rgba(51,106,152,1)","rgba(77,159,222,1)","rgba(59,123,175,1)","rgba(59,123,175,1)","rgba(51,106,152,1)","rgba(59,123,175,1)","rgba(77,159,222,1)"],"opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":["rgba(51,106,152,1)","rgba(59,123,175,1)","rgba(59,123,175,1)","rgba(27,58,87,1)","rgba(86,177,247,1)","rgba(68,141,198,1)","rgba(86,177,247,1)","rgba(59,123,175,1)","rgba(51,106,152,1)","rgba(68,141,198,1)","rgba(77,159,222,1)","rgba(68,141,198,1)","rgba(59,123,175,1)","rgba(77,159,222,1)","rgba(77,159,222,1)","rgba(59,123,175,1)","rgba(27,58,87,1)","rgba(42,90,130,1)","rgba(27,58,87,1)","rgba(27,58,87,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(51,106,152,1)","rgba(68,141,198,1)","rgba(68,141,198,1)","rgba(51,106,152,1)","rgba(59,123,175,1)","rgba(34,73,108,1)","rgba(19,43,67,1)","rgba(27,58,87,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(42,90,130,1)","rgba(86,177,247,1)","rgba(68,141,198,1)","rgba(77,159,222,1)","rgba(86,177,247,1)","rgba(51,106,152,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(77,159,222,1)","rgba(59,123,175,1)","rgba(51,106,152,1)","rgba(68,141,198,1)","rgba(86,177,247,1)","rgba(68,141,198,1)","rgba(68,141,198,1)","rgba(68,141,198,1)","rgba(77,159,222,1)","rgba(42,90,130,1)","rgba(51,106,152,1)","rgba(51,106,152,1)","rgba(27,58,87,1)","rgba(34,73,108,1)","rgba(68,141,198,1)","rgba(42,90,130,1)","rgba(27,58,87,1)","rgba(19,43,67,1)","rgba(51,106,152,1)","rgba(77,159,222,1)","rgba(77,159,222,1)","rgba(77,159,222,1)","rgba(86,177,247,1)","rgba(77,159,222,1)","rgba(77,159,222,1)","rgba(77,159,222,1)","rgba(68,141,198,1)","rgba(59,123,175,1)","rgba(27,58,87,1)","rgba(59,123,175,1)","rgba(77,159,222,1)","rgba(42,90,130,1)","rgba(59,123,175,1)","rgba(77,159,222,1)","rgba(59,123,175,1)","rgba(27,58,87,1)","rgba(68,141,198,1)","rgba(42,90,130,1)","rgba(19,43,67,1)","rgba(27,58,87,1)","rgba(86,177,247,1)","rgba(51,106,152,1)","rgba(68,141,198,1)","rgba(77,159,222,1)","rgba(77,159,222,1)","rgba(77,159,222,1)","rgba(59,123,175,1)","rgba(59,123,175,1)","rgba(77,159,222,1)","rgba(59,123,175,1)","rgba(59,123,175,1)","rgba(77,159,222,1)","rgba(59,123,175,1)","rgba(86,177,247,1)","rgba(59,123,175,1)","rgba(77,159,222,1)","rgba(59,123,175,1)","rgba(77,159,222,1)","rgba(59,123,175,1)","rgba(59,123,175,1)","rgba(77,159,222,1)","rgba(77,159,222,1)","rgba(77,159,222,1)","rgba(42,90,130,1)","rgba(34,73,108,1)","rgba(51,106,152,1)","rgba(77,159,222,1)","rgba(59,123,175,1)","rgba(59,123,175,1)","rgba(51,106,152,1)","rgba(59,123,175,1)","rgba(77,159,222,1)"]}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[15],"y":[40],"name":"99_8442327c872c6180905676e22ff8e953","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#132B43"],[0.0625,"#17324D"],[0.125,"#1B3A57"],[0.1875,"#1E4261"],[0.25,"#22496C"],[0.3125,"#265177"],[0.375,"#2A5A82"],[0.4375,"#2F628D"],[0.5,"#336A98"],[0.5625,"#3773A3"],[0.625,"#3B7BAF"],[0.6875,"#4084BB"],[0.75,"#448DC6"],[0.8125,"#4896D2"],[0.875,"#4D9FDE"],[0.9375,"#51A8EB"],[1,"#56B1F7"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"thickness":23.04,"title":"Ne12","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"tickmode":"array","ticktext":["0","2","4","6","8"],"tickvals":[0,0.25,0.5,0.75,1],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":43.1050228310502},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[13.025,34.475],"ticktext":["15","20","25","30"],"tickvals":[15,20,25,30],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"T12","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[35.8,172.2],"ticktext":["40","80","120","160"],"tickvals":[40,80,120,160],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"maxO3","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest"},"source":"A","attrs":{"51ac11806bc0":{"colour":{},"x":{},"y":{},"type":"ggplotly"}},"cur_data":"51ac11806bc0","visdat":{"51ac11806bc0":["function (y) ","x"]},"config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(ozone, <span class="kw">aes</span>(wind, maxO3)) +<span class="st">  </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplotly</span>()</code></pre></div>
<pre><code>## We recommend that you use the dev version of ggplot2 with `ggplotly()`
## Install it with: `devtools::install_github(&#39;hadley/ggplot2&#39;)`</code></pre>
<div id="51ac4fd64203" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="51ac4fd64203">{"x":{"data":[{"x":[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],"y":[87,82,77,114,81,84,97,79,101,42,101,83,66,153,83,92,121,78,75,81,71,71,59,70,69,70,60,101,159,92,71,112,92,96,45,114,126,146,106,121,98,106,94,56,88,145,98,79,83,57,113,149,72,88,71,78,63,77,67,88,72,63,79,65,72,70,55,149,59,156,80,76,71,77,76,65,100,131,67,67,83,63,111,69,68,67,76,166,76,60,74,84,116,139,90,72,54,146,160,66,93,113,109,81,108,159,117,84,77,99,116,70],"hoverinfo":"y","type":"box","fillcolor":"rgba(255,255,255,1)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"},"size":5.66929133858268},"line":{"color":"rgba(51,51,51,1)","width":1.88976377952756},"showlegend":false,"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":43.1050228310502},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[0.4,4.6],"ticktext":["East","North","South","West"],"tickvals":[1,2,3,4],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"wind","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[35.8,172.2],"ticktext":["40","80","120","160"],"tickvals":[40,80,120,160],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"maxO3","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest"},"source":"A","attrs":{"51ac1bb23199":{"x":{},"y":{},"type":"ggplotly"}},"cur_data":"51ac1bb23199","visdat":{"51ac1bb23199":["function (y) ","x"]},"config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<p>One of my favourite to finish!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dygraphs)
<span class="kw">library</span>(xts)</code></pre></div>
<pre><code>## Loading required package: zoo</code></pre>
<pre><code>## 
## Attaching package: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dates &lt;-<span class="st"> </span><span class="kw">as.Date</span>(<span class="kw">rownames</span>(ozone), <span class="st">&quot;%Y%m%d&quot;</span>)
aa=<span class="st"> </span><span class="kw">cbind.data.frame</span>(dates,ozone[, <span class="st">&quot;maxO3&quot;</span>])
myobj &lt;-<span class="st"> </span><span class="kw">as.xts</span>(aa[,<span class="dv">2</span>], <span class="dt">order.by =</span> aa[,<span class="dv">1</span>])
res &lt;-<span class="st"> </span><span class="kw">dygraph</span>(myobj, <span class="dt">main =</span> <span class="st">&quot;Ozone Concentartion&quot;</span>) 
<span class="kw">dyRangeSelector</span>(res, <span class="dt">dateWindow =</span> <span class="kw">c</span>(<span class="st">&quot;2001-06-01&quot;</span>, <span class="st">&quot;2001-09-30&quot;</span>))</code></pre></div>
<div id="htmlwidget-0b8de34cc89e8ba29799" style="width:672px;height:480px;" class="dygraphs html-widget"></div>
<script type="application/json" data-for="htmlwidget-0b8de34cc89e8ba29799">{"x":{"attrs":{"title":"Ozone Concentartion","labels":["day","V1"],"legend":"auto","retainDateWindow":false,"axes":{"x":{"pixelsPerLabel":60}},"showRangeSelector":true,"dateWindow":["2001-06-01T00:00:00.000Z","2001-09-30T00:00:00.000Z"],"rangeSelectorHeight":40,"rangeSelectorPlotFillColor":" #A7B1C4","rangeSelectorPlotStrokeColor":"#808FAB","interactionModel":"Dygraph.Interaction.defaultModel"},"scale":"daily","annotations":[],"shadings":[],"events":[],"format":"date","data":[["2001-06-01T00:00:00.000Z","2001-06-02T00:00:00.000Z","2001-06-03T00:00:00.000Z","2001-06-04T00:00:00.000Z","2001-06-05T00:00:00.000Z","2001-06-06T00:00:00.000Z","2001-06-07T00:00:00.000Z","2001-06-10T00:00:00.000Z","2001-06-11T00:00:00.000Z","2001-06-12T00:00:00.000Z","2001-06-13T00:00:00.000Z","2001-06-14T00:00:00.000Z","2001-06-15T00:00:00.000Z","2001-06-16T00:00:00.000Z","2001-06-17T00:00:00.000Z","2001-06-18T00:00:00.000Z","2001-06-20T00:00:00.000Z","2001-06-21T00:00:00.000Z","2001-06-22T00:00:00.000Z","2001-06-23T00:00:00.000Z","2001-06-24T00:00:00.000Z","2001-06-25T00:00:00.000Z","2001-06-26T00:00:00.000Z","2001-06-27T00:00:00.000Z","2001-06-28T00:00:00.000Z","2001-06-29T00:00:00.000Z","2001-06-30T00:00:00.000Z","2001-07-01T00:00:00.000Z","2001-07-02T00:00:00.000Z","2001-07-03T00:00:00.000Z","2001-07-04T00:00:00.000Z","2001-07-05T00:00:00.000Z","2001-07-06T00:00:00.000Z","2001-07-07T00:00:00.000Z","2001-07-08T00:00:00.000Z","2001-07-09T00:00:00.000Z","2001-07-10T00:00:00.000Z","2001-07-11T00:00:00.000Z","2001-07-12T00:00:00.000Z","2001-07-13T00:00:00.000Z","2001-07-14T00:00:00.000Z","2001-07-15T00:00:00.000Z","2001-07-16T00:00:00.000Z","2001-07-17T00:00:00.000Z","2001-07-18T00:00:00.000Z","2001-07-19T00:00:00.000Z","2001-07-20T00:00:00.000Z","2001-07-21T00:00:00.000Z","2001-07-22T00:00:00.000Z","2001-07-23T00:00:00.000Z","2001-07-24T00:00:00.000Z","2001-07-25T00:00:00.000Z","2001-07-26T00:00:00.000Z","2001-07-27T00:00:00.000Z","2001-07-28T00:00:00.000Z","2001-07-29T00:00:00.000Z","2001-07-30T00:00:00.000Z","2001-07-31T00:00:00.000Z","2001-08-01T00:00:00.000Z","2001-08-02T00:00:00.000Z","2001-08-03T00:00:00.000Z","2001-08-04T00:00:00.000Z","2001-08-05T00:00:00.000Z","2001-08-06T00:00:00.000Z","2001-08-07T00:00:00.000Z","2001-08-08T00:00:00.000Z","2001-08-09T00:00:00.000Z","2001-08-10T00:00:00.000Z","2001-08-11T00:00:00.000Z","2001-08-12T00:00:00.000Z","2001-08-13T00:00:00.000Z","2001-08-14T00:00:00.000Z","2001-08-15T00:00:00.000Z","2001-08-19T00:00:00.000Z","2001-08-20T00:00:00.000Z","2001-08-21T00:00:00.000Z","2001-08-22T00:00:00.000Z","2001-08-23T00:00:00.000Z","2001-08-24T00:00:00.000Z","2001-08-25T00:00:00.000Z","2001-08-26T00:00:00.000Z","2001-08-27T00:00:00.000Z","2001-08-28T00:00:00.000Z","2001-08-29T00:00:00.000Z","2001-08-30T00:00:00.000Z","2001-08-31T00:00:00.000Z","2001-09-01T00:00:00.000Z","2001-09-02T00:00:00.000Z","2001-09-03T00:00:00.000Z","2001-09-04T00:00:00.000Z","2001-09-05T00:00:00.000Z","2001-09-06T00:00:00.000Z","2001-09-07T00:00:00.000Z","2001-09-08T00:00:00.000Z","2001-09-12T00:00:00.000Z","2001-09-13T00:00:00.000Z","2001-09-14T00:00:00.000Z","2001-09-15T00:00:00.000Z","2001-09-16T00:00:00.000Z","2001-09-17T00:00:00.000Z","2001-09-18T00:00:00.000Z","2001-09-19T00:00:00.000Z","2001-09-20T00:00:00.000Z","2001-09-21T00:00:00.000Z","2001-09-22T00:00:00.000Z","2001-09-23T00:00:00.000Z","2001-09-24T00:00:00.000Z","2001-09-25T00:00:00.000Z","2001-09-27T00:00:00.000Z","2001-09-28T00:00:00.000Z","2001-09-29T00:00:00.000Z","2001-09-30T00:00:00.000Z"],[87,82,92,114,94,80,79,79,101,106,101,90,72,70,83,88,145,81,121,146,121,146,108,83,57,81,67,70,106,139,79,93,97,113,72,88,77,71,56,45,67,67,84,63,69,92,88,66,72,81,83,149,153,159,149,160,156,84,126,116,77,63,54,65,72,60,70,77,98,111,75,116,109,67,76,113,117,131,166,159,100,114,112,101,76,59,78,76,55,71,66,59,68,63,78,74,71,69,71,60,42,65,71,96,98,92,76,84,77,99,83,70]]},"evals":["attrs.interactionModel"],"jsHooks":[]}</script>
<!-- df1K=data.frame(errs=sim1K)
h1=ggplot(df1K,aes(x=errs))
h1+geom_histogram(bins=50,colour = "darkgreen", fill = "white") -->
</div>
<div id="spatial-graphs" class="section level2">
<h2><span class="header-section-number">5.4</span> Spatial graphs</h2>
<p>We will just show that you can create maps in R. It requires a bit of new command and packages but it will give you some hints about how to proceed to do such maps.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(maps)</code></pre></div>
<pre><code>## 
## Attaching package: &#39;maps&#39;</code></pre>
<pre><code>## The following object is masked _by_ &#39;.GlobalEnv&#39;:
## 
##     ozone</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">help</span>(map_data)
<span class="co"># This first example is given in map_data</span>

states &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">&quot;state&quot;</span>)
?USArrests <span class="co"># You have a data set with Murder/100000 habs in US states</span>
arrests &lt;-<span class="st"> </span>USArrests
<span class="kw">names</span>(arrests) &lt;-<span class="st"> </span><span class="kw">tolower</span>(<span class="kw">names</span>(arrests))
arrests$region &lt;-<span class="st"> </span><span class="kw">tolower</span>(<span class="kw">rownames</span>(USArrests))

choro &lt;-<span class="st"> </span><span class="kw">merge</span>(states, arrests, <span class="dt">sort =</span> <span class="ot">FALSE</span>, <span class="dt">by =</span> <span class="st">&quot;region&quot;</span>)
choro &lt;-<span class="st"> </span>choro[<span class="kw">order</span>(choro$order), ]

<span class="kw">ggplot</span>(choro, <span class="kw">aes</span>(long, lat)) +
<span class="st">  </span><span class="kw">geom_polygon</span>(<span class="kw">aes</span>(<span class="dt">group =</span> group, <span class="dt">fill =</span> assault)) +
<span class="st">  </span><span class="kw">coord_map</span>(<span class="st">&quot;albers&quot;</span>,  <span class="dt">at0 =</span> <span class="fl">45.5</span>, <span class="dt">lat1 =</span> <span class="fl">29.5</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<p>Another a bit more complicated example (Credit C. Sabbati):</p>
<p><code>r   CountyGrid&lt;-map_data(&quot;county&quot;)    StateGrid&lt;-map_data(&quot;state&quot;)   head(CountyGrid)</code></p>
<p><code>##        long      lat group order  region subregion   ## 1 -86.50517 32.34920     1     1 alabama   autauga   ## 2 -86.53382 32.35493     1     2 alabama   autauga   ## 3 -86.54527 32.36639     1     3 alabama   autauga   ## 4 -86.55673 32.37785     1     4 alabama   autauga   ## 5 -86.57966 32.38357     1     5 alabama   autauga   ## 6 -86.59111 32.37785     1     6 alabama   autauga</code></p>
<p><code>r   CountyGrid$state&lt;-CountyGrid$region   CountyGrid$county&lt;-CountyGrid$subregion   data&lt;-read.table(file=&quot;data/NewIncomeData.csv&quot;,sep=&quot;,&quot;,header=T)   DataToMap&lt;-merge(CountyGrid,data,by=c(&quot;state&quot;,&quot;county&quot;))   DataToMap&lt;-DataToMap[order(DataToMap$order),]   DataToMap$percapita&lt;-(DataToMap$Wages_Salaries+DataToMap$Dividends)/DataToMap$Return_Num   DataToMap$percapita.d&lt;-cut(DataToMap$percapita, breaks=c(seq(15,55,10),87.02))   data_source = ggplot(DataToMap, aes(long, lat, group = group))  # this is where the data lives   county_polygons = geom_polygon(aes(fill = percapita.d), colour = alpha(&quot;white&quot;, 1/2), size = 0.2)  # add in the polygons in the data, filled by the attribute precapita   state_boundaries = geom_polygon(data = StateGrid, colour = &quot;white&quot;, fill = NA)  # add in the state boundaries from state_df   color_mapper = scale_fill_brewer(&quot;PerCapita Wages&quot;, palette = &quot;PuRd&quot;)  # how do we fill polygons in this plot?   income_plot = (data_source + county_polygons + state_boundaries + color_mapper)   print(income_plot)</code></p>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<p><code>r  #non cartogram view  attach(data)  par(las=2,mar=c(7, 4, 4, 2))  plot(state,(Wages_Salaries+Dividends)/Return_Num)</code></p>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<p>Finally with interaction:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(plotly)
df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/plotly/datasets/master/2011_us_ag_exports.csv&quot;</span>)
df$hover &lt;-<span class="st"> </span><span class="kw">with</span>(df, <span class="kw">paste</span>(state, <span class="st">&#39;&lt;br&gt;&#39;</span>, <span class="st">&quot;Beef&quot;</span>, beef, <span class="st">&quot;Dairy&quot;</span>, dairy, <span class="st">&quot;&lt;br&gt;&quot;</span>,
                           <span class="st">&quot;Fruits&quot;</span>, total.fruits, <span class="st">&quot;Veggies&quot;</span>, total.veggies,
                           <span class="st">&quot;&lt;br&gt;&quot;</span>, <span class="st">&quot;Wheat&quot;</span>, wheat, <span class="st">&quot;Corn&quot;</span>, corn))
<span class="co"># give state boundaries a white border</span>
l &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">color =</span> <span class="kw">toRGB</span>(<span class="st">&quot;white&quot;</span>), <span class="dt">width =</span> <span class="dv">2</span>)
<span class="co"># specify some map projection/options</span>
g &lt;-<span class="st"> </span><span class="kw">list</span>(
  <span class="dt">scope =</span> <span class="st">&#39;usa&#39;</span>,
  <span class="dt">projection =</span> <span class="kw">list</span>(<span class="dt">type =</span> <span class="st">&#39;albers usa&#39;</span>),
  <span class="dt">showlakes =</span> <span class="ot">TRUE</span>,
  <span class="dt">lakecolor =</span> <span class="kw">toRGB</span>(<span class="st">&#39;white&#39;</span>)
)
<span class="kw">attach</span>(df)</code></pre></div>
<pre><code>## The following object is masked from data:
## 
##     state</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">aa &lt;-<span class="st"> </span><span class="kw">plot_ly</span>(df, <span class="dt">z =</span> total.exports, <span class="dt">text =</span> hover, <span class="dt">locations =</span> code, <span class="dt">type =</span> <span class="st">&#39;choropleth&#39;</span>,
              <span class="dt">locationmode =</span> <span class="st">&#39;USA-states&#39;</span>, <span class="dt">color =</span> total.exports, <span class="dt">colors =</span> <span class="st">&#39;Purples&#39;</span>,
              <span class="dt">marker =</span> <span class="kw">list</span>(<span class="dt">line =</span> l), <span class="dt">colorbar =</span> <span class="kw">list</span>(<span class="dt">title =</span> <span class="st">&quot;Millions USD&quot;</span>))
<span class="kw">layout</span>(aa, <span class="dt">title =</span> <span class="st">&#39;2011 US Agriculture Exports by State&#39;</span>, <span class="dt">geo =</span> g)</code></pre></div>
<div id="51ac683fb90e" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="51ac683fb90e">{"x":{"visdat":{"51ac7c4c1a02":["function () ","plotlyVisDat"]},"cur_data":"51ac7c4c1a02","attrs":{"51ac7c4c1a02":{"z":[1390.63,13.31,1463.17,3586.02,16472.88,1851.33,259.62,282.19,3764.09,2860.84,401.84,2078.89,8709.48,5050.23,11273.76,4589.01,1889.15,1914.23,278.37,692.75,248.65,3164.16,7192.33,2170.8,3933.42,1718,7114.13,139.89,73.06,500.4,751.58,1488.9,3806.05,3761.96,3979.79,1646.41,1794.57,1969.87,31.59,929.93,3770.19,1535.13,6648.22,453.39,180.14,1146.48,3894.81,138.89,3090.23,349.69],"text":["Alabama <br> Beef 34.4 Dairy 4.06 <br> Fruits 25.11 Veggies 14.33 <br> Wheat 70 Corn 34.9","Alaska <br> Beef 0.2 Dairy 0.19 <br> Fruits 0 Veggies 1.56 <br> Wheat 0 Corn 0","Arizona <br> Beef 71.3 Dairy 105.48 <br> Fruits 60.27 Veggies 386.91 <br> Wheat 48.7 Corn 7.3","Arkansas <br> Beef 53.2 Dairy 3.53 <br> Fruits 6.88 Veggies 11.45 <br> Wheat 114.5 Corn 69.5"," California <br> Beef 228.7 Dairy 929.95 <br> Fruits 8736.4 Veggies 2106.79 <br> Wheat 249.3 Corn 34.6","Colorado <br> Beef 261.4 Dairy 71.94 <br> Fruits 17.99 Veggies 118.27 <br> Wheat 400.5 Corn 183.2","Connecticut <br> Beef 1.1 Dairy 9.49 <br> Fruits 13.1 Veggies 11.16 <br> Wheat 0 Corn 0","Delaware <br> Beef 0.4 Dairy 2.3 <br> Fruits 1.53 Veggies 20.03 <br> Wheat 22.9 Corn 26.9","Florida <br> Beef 42.6 Dairy 66.31 <br> Fruits 1371.36 Veggies 450.86 <br> Wheat 1.8 Corn 3.5","Georgia <br> Beef 31 Dairy 38.38 <br> Fruits 233.51 Veggies 154.77 <br> Wheat 65.4 Corn 57.8","Hawaii <br> Beef 4 Dairy 1.16 <br> Fruits 55.51 Veggies 24.83 <br> Wheat 0 Corn 0","Idaho <br> Beef 119.8 Dairy 294.6 <br> Fruits 21.64 Veggies 319.19 <br> Wheat 568.2 Corn 24","Illinois <br> Beef 53.7 Dairy 45.82 <br> Fruits 12.53 Veggies 39.95 <br> Wheat 223.8 Corn 2228.5","Indiana <br> Beef 21.9 Dairy 89.7 <br> Fruits 12.98 Veggies 37.89 <br> Wheat 114 Corn 1123.2","Iowa <br> Beef 289.8 Dairy 107 <br> Fruits 3.24 Veggies 7.1 <br> Wheat 3.1 Corn 2529.8","Kansas <br> Beef 659.3 Dairy 65.45 <br> Fruits 3.11 Veggies 9.32 <br> Wheat 1426.5 Corn 457.3","Kentucky <br> Beef 54.8 Dairy 28.27 <br> Fruits 6.6 Veggies 0 <br> Wheat 149.3 Corn 179.1","Louisiana <br> Beef 19.8 Dairy 6.02 <br> Fruits 17.83 Veggies 17.25 <br> Wheat 78.7 Corn 91.4","Maine <br> Beef 1.4 Dairy 16.18 <br> Fruits 52.01 Veggies 62.9 <br> Wheat 0 Corn 0","Maryland <br> Beef 5.6 Dairy 24.81 <br> Fruits 12.9 Veggies 20.43 <br> Wheat 55.8 Corn 54.1","Massachusetts <br> Beef 0.6 Dairy 5.81 <br> Fruits 80.83 Veggies 21.13 <br> Wheat 0 Corn 0","Michigan <br> Beef 37.7 Dairy 214.82 <br> Fruits 257.69 Veggies 189.96 <br> Wheat 247 Corn 381.5","Minnesota <br> Beef 112.3 Dairy 218.05 <br> Fruits 7.91 Veggies 120.37 <br> Wheat 538.1 Corn 1264.3","Mississippi <br> Beef 12.8 Dairy 5.45 <br> Fruits 17.04 Veggies 27.87 <br> Wheat 102.2 Corn 110","Missouri <br> Beef 137.2 Dairy 34.26 <br> Fruits 13.18 Veggies 17.9 <br> Wheat 161.7 Corn 428.8","Montana <br> Beef 105 Dairy 6.82 <br> Fruits 3.3 Veggies 45.27 <br> Wheat 1198.1 Corn 5.4","Nebraska <br> Beef 762.2 Dairy 30.07 <br> Fruits 2.16 Veggies 53.5 <br> Wheat 292.3 Corn 1735.9","Nevada <br> Beef 21.8 Dairy 16.57 <br> Fruits 1.19 Veggies 27.93 <br> Wheat 5.4 Corn 0","New Hampshire <br> Beef 0.6 Dairy 7.46 <br> Fruits 7.98 Veggies 4.5 <br> Wheat 0 Corn 0","New Jersey <br> Beef 0.8 Dairy 3.37 <br> Fruits 109.45 Veggies 56.54 <br> Wheat 6.7 Corn 10.1","New Mexico <br> Beef 117.2 Dairy 191.01 <br> Fruits 101.9 Veggies 43.88 <br> Wheat 13.9 Corn 11.2","New York <br> Beef 22.2 Dairy 331.8 <br> Fruits 202.56 Veggies 143.37 <br> Wheat 29.9 Corn 106.1","North Carolina <br> Beef 24.8 Dairy 24.9 <br> Fruits 74.47 Veggies 150.45 <br> Wheat 200.3 Corn 92.2","North Dakota <br> Beef 78.5 Dairy 8.14 <br> Fruits 0.25 Veggies 130.79 <br> Wheat 1664.5 Corn 236.1","Ohio <br> Beef 36.2 Dairy 134.57 <br> Fruits 27.21 Veggies 53.53 <br> Wheat 207.4 Corn 535.1","Oklahoma <br> Beef 337.6 Dairy 24.35 <br> Fruits 9.24 Veggies 8.9 <br> Wheat 324.8 Corn 27.5","Oregon <br> Beef 58.8 Dairy 63.66 <br> Fruits 315.04 Veggies 126.5 <br> Wheat 320.3 Corn 11.7","Pennsylvania <br> Beef 50.9 Dairy 280.87 <br> Fruits 89.48 Veggies 38.26 <br> Wheat 41 Corn 112.1","Rhode Island <br> Beef 0.1 Dairy 0.52 <br> Fruits 2.83 Veggies 3.02 <br> Wheat 0 Corn 0","South Carolina <br> Beef 15.2 Dairy 7.62 <br> Fruits 53.45 Veggies 42.66 <br> Wheat 55.3 Corn 32.1","South Dakota <br> Beef 193.5 Dairy 46.77 <br> Fruits 0.8 Veggies 4.06 <br> Wheat 704.5 Corn 643.6","Tennessee <br> Beef 51.1 Dairy 21.18 <br> Fruits 6.23 Veggies 24.67 <br> Wheat 100 Corn 88.8","Texas <br> Beef 961 Dairy 240.55 <br> Fruits 99.9 Veggies 115.23 <br> Wheat 309.7 Corn 167.2","Utah <br> Beef 27.9 Dairy 48.6 <br> Fruits 12.34 Veggies 6.6 <br> Wheat 42.8 Corn 5.3","Vermont <br> Beef 6.2 Dairy 65.98 <br> Fruits 8.01 Veggies 4.05 <br> Wheat 0 Corn 0","Virginia <br> Beef 39.5 Dairy 47.85 <br> Fruits 36.48 Veggies 27.25 <br> Wheat 77.5 Corn 39.5","Washington <br> Beef 59.2 Dairy 154.18 <br> Fruits 1738.57 Veggies 363.79 <br> Wheat 786.3 Corn 29.5","West Virginia <br> Beef 12 Dairy 3.9 <br> Fruits 11.54 Veggies 0 <br> Wheat 1.6 Corn 3.5","Wisconsin <br> Beef 107.3 Dairy 633.6 <br> Fruits 133.8 Veggies 148.99 <br> Wheat 96.7 Corn 460.5","Wyoming <br> Beef 75.1 Dairy 2.89 <br> Fruits 0.17 Veggies 10.23 <br> Wheat 20.7 Corn 9"],"locations":["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"],"locationmode":"USA-states","marker":{"line":{"color":"rgba(255,255,255,1)","width":2}},"colorbar":{"title":"Millions USD"},"color":[1390.63,13.31,1463.17,3586.02,16472.88,1851.33,259.62,282.19,3764.09,2860.84,401.84,2078.89,8709.48,5050.23,11273.76,4589.01,1889.15,1914.23,278.37,692.75,248.65,3164.16,7192.33,2170.8,3933.42,1718,7114.13,139.89,73.06,500.4,751.58,1488.9,3806.05,3761.96,3979.79,1646.41,1794.57,1969.87,31.59,929.93,3770.19,1535.13,6648.22,453.39,180.14,1146.48,3894.81,138.89,3090.23,349.69],"colors":"Purples","alpha":1,"sizes":[10,100],"type":"choropleth"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"2011 US Agriculture Exports by State","geo":{"scope":"usa","projection":{"type":"albers usa"},"showlakes":true,"lakecolor":"rgba(255,255,255,1)"},"xaxis":{"domain":[0,1]},"yaxis":{"domain":[0,1]},"hovermode":"closest","showlegend":false,"legend":{"y":0.5,"yanchor":"top"}},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"colorbar":{"title":"Millions USD","ticklen":2,"len":0.5,"y":1,"lenmode":"fraction","yanchor":"top"},"colorscale":[["0","rgba(252,251,253,1)"],["0.00379675268957006","rgba(252,251,253,1)"],["0.00789414101745469","rgba(251,250,252,1)"],["0.0143813750906008","rgba(251,249,252,1)"],["0.0161423820103846","rgba(250,249,252,1)"],["0.0210968198642694","rgba(250,249,252,1)"],["0.0274510512729069","rgba(249,248,251,1)"],["0.0423218073133138","rgba(248,246,250,1)"],["0.0600746759078963","rgba(246,244,249,1)"],["0.0853316641929285","rgba(243,241,248,1)"],["0.0908196568926163","rgba(243,241,247,1)"],["0.101212369662958","rgba(241,240,247,1)"],["0.109944548976674","rgba(241,239,246,1)"],["0.114791880954363","rgba(240,238,246,1)"],["0.122734372769155","rgba(239,237,245,1)"],["0.157280232715679","rgba(234,232,242,1)"],["0.189932462796213","rgba(228,227,240,1)"],["0.224631273275466","rgba(222,222,237,1)"],["0.228156324861464","rgba(222,221,237,1)"],["0.234696795440788","rgba(221,220,236,1)"],["0.240513674820586","rgba(220,219,236,1)"],["0.302515041401446","rgba(205,206,229,1)"],["0.429050951310798","rgba(175,174,211,1)"],["0.524494589874867","rgba(152,148,197,1)"],["1","rgba(63,0,125,1)"]],"showscale":true,"z":[1390.63,13.31,1463.17,3586.02,16472.88,1851.33,259.62,282.19,3764.09,2860.84,401.84,2078.89,8709.48,5050.23,11273.76,4589.01,1889.15,1914.23,278.37,692.75,248.65,3164.16,7192.33,2170.8,3933.42,1718,7114.13,139.89,73.06,500.4,751.58,1488.9,3806.05,3761.96,3979.79,1646.41,1794.57,1969.87,31.59,929.93,3770.19,1535.13,6648.22,453.39,180.14,1146.48,3894.81,138.89,3090.23,349.69],"text":["Alabama <br> Beef 34.4 Dairy 4.06 <br> Fruits 25.11 Veggies 14.33 <br> Wheat 70 Corn 34.9","Alaska <br> Beef 0.2 Dairy 0.19 <br> Fruits 0 Veggies 1.56 <br> Wheat 0 Corn 0","Arizona <br> Beef 71.3 Dairy 105.48 <br> Fruits 60.27 Veggies 386.91 <br> Wheat 48.7 Corn 7.3","Arkansas <br> Beef 53.2 Dairy 3.53 <br> Fruits 6.88 Veggies 11.45 <br> Wheat 114.5 Corn 69.5"," California <br> Beef 228.7 Dairy 929.95 <br> Fruits 8736.4 Veggies 2106.79 <br> Wheat 249.3 Corn 34.6","Colorado <br> Beef 261.4 Dairy 71.94 <br> Fruits 17.99 Veggies 118.27 <br> Wheat 400.5 Corn 183.2","Connecticut <br> Beef 1.1 Dairy 9.49 <br> Fruits 13.1 Veggies 11.16 <br> Wheat 0 Corn 0","Delaware <br> Beef 0.4 Dairy 2.3 <br> Fruits 1.53 Veggies 20.03 <br> Wheat 22.9 Corn 26.9","Florida <br> Beef 42.6 Dairy 66.31 <br> Fruits 1371.36 Veggies 450.86 <br> Wheat 1.8 Corn 3.5","Georgia <br> Beef 31 Dairy 38.38 <br> Fruits 233.51 Veggies 154.77 <br> Wheat 65.4 Corn 57.8","Hawaii <br> Beef 4 Dairy 1.16 <br> Fruits 55.51 Veggies 24.83 <br> Wheat 0 Corn 0","Idaho <br> Beef 119.8 Dairy 294.6 <br> Fruits 21.64 Veggies 319.19 <br> Wheat 568.2 Corn 24","Illinois <br> Beef 53.7 Dairy 45.82 <br> Fruits 12.53 Veggies 39.95 <br> Wheat 223.8 Corn 2228.5","Indiana <br> Beef 21.9 Dairy 89.7 <br> Fruits 12.98 Veggies 37.89 <br> Wheat 114 Corn 1123.2","Iowa <br> Beef 289.8 Dairy 107 <br> Fruits 3.24 Veggies 7.1 <br> Wheat 3.1 Corn 2529.8","Kansas <br> Beef 659.3 Dairy 65.45 <br> Fruits 3.11 Veggies 9.32 <br> Wheat 1426.5 Corn 457.3","Kentucky <br> Beef 54.8 Dairy 28.27 <br> Fruits 6.6 Veggies 0 <br> Wheat 149.3 Corn 179.1","Louisiana <br> Beef 19.8 Dairy 6.02 <br> Fruits 17.83 Veggies 17.25 <br> Wheat 78.7 Corn 91.4","Maine <br> Beef 1.4 Dairy 16.18 <br> Fruits 52.01 Veggies 62.9 <br> Wheat 0 Corn 0","Maryland <br> Beef 5.6 Dairy 24.81 <br> Fruits 12.9 Veggies 20.43 <br> Wheat 55.8 Corn 54.1","Massachusetts <br> Beef 0.6 Dairy 5.81 <br> Fruits 80.83 Veggies 21.13 <br> Wheat 0 Corn 0","Michigan <br> Beef 37.7 Dairy 214.82 <br> Fruits 257.69 Veggies 189.96 <br> Wheat 247 Corn 381.5","Minnesota <br> Beef 112.3 Dairy 218.05 <br> Fruits 7.91 Veggies 120.37 <br> Wheat 538.1 Corn 1264.3","Mississippi <br> Beef 12.8 Dairy 5.45 <br> Fruits 17.04 Veggies 27.87 <br> Wheat 102.2 Corn 110","Missouri <br> Beef 137.2 Dairy 34.26 <br> Fruits 13.18 Veggies 17.9 <br> Wheat 161.7 Corn 428.8","Montana <br> Beef 105 Dairy 6.82 <br> Fruits 3.3 Veggies 45.27 <br> Wheat 1198.1 Corn 5.4","Nebraska <br> Beef 762.2 Dairy 30.07 <br> Fruits 2.16 Veggies 53.5 <br> Wheat 292.3 Corn 1735.9","Nevada <br> Beef 21.8 Dairy 16.57 <br> Fruits 1.19 Veggies 27.93 <br> Wheat 5.4 Corn 0","New Hampshire <br> Beef 0.6 Dairy 7.46 <br> Fruits 7.98 Veggies 4.5 <br> Wheat 0 Corn 0","New Jersey <br> Beef 0.8 Dairy 3.37 <br> Fruits 109.45 Veggies 56.54 <br> Wheat 6.7 Corn 10.1","New Mexico <br> Beef 117.2 Dairy 191.01 <br> Fruits 101.9 Veggies 43.88 <br> Wheat 13.9 Corn 11.2","New York <br> Beef 22.2 Dairy 331.8 <br> Fruits 202.56 Veggies 143.37 <br> Wheat 29.9 Corn 106.1","North Carolina <br> Beef 24.8 Dairy 24.9 <br> Fruits 74.47 Veggies 150.45 <br> Wheat 200.3 Corn 92.2","North Dakota <br> Beef 78.5 Dairy 8.14 <br> Fruits 0.25 Veggies 130.79 <br> Wheat 1664.5 Corn 236.1","Ohio <br> Beef 36.2 Dairy 134.57 <br> Fruits 27.21 Veggies 53.53 <br> Wheat 207.4 Corn 535.1","Oklahoma <br> Beef 337.6 Dairy 24.35 <br> Fruits 9.24 Veggies 8.9 <br> Wheat 324.8 Corn 27.5","Oregon <br> Beef 58.8 Dairy 63.66 <br> Fruits 315.04 Veggies 126.5 <br> Wheat 320.3 Corn 11.7","Pennsylvania <br> Beef 50.9 Dairy 280.87 <br> Fruits 89.48 Veggies 38.26 <br> Wheat 41 Corn 112.1","Rhode Island <br> Beef 0.1 Dairy 0.52 <br> Fruits 2.83 Veggies 3.02 <br> Wheat 0 Corn 0","South Carolina <br> Beef 15.2 Dairy 7.62 <br> Fruits 53.45 Veggies 42.66 <br> Wheat 55.3 Corn 32.1","South Dakota <br> Beef 193.5 Dairy 46.77 <br> Fruits 0.8 Veggies 4.06 <br> Wheat 704.5 Corn 643.6","Tennessee <br> Beef 51.1 Dairy 21.18 <br> Fruits 6.23 Veggies 24.67 <br> Wheat 100 Corn 88.8","Texas <br> Beef 961 Dairy 240.55 <br> Fruits 99.9 Veggies 115.23 <br> Wheat 309.7 Corn 167.2","Utah <br> Beef 27.9 Dairy 48.6 <br> Fruits 12.34 Veggies 6.6 <br> Wheat 42.8 Corn 5.3","Vermont <br> Beef 6.2 Dairy 65.98 <br> Fruits 8.01 Veggies 4.05 <br> Wheat 0 Corn 0","Virginia <br> Beef 39.5 Dairy 47.85 <br> Fruits 36.48 Veggies 27.25 <br> Wheat 77.5 Corn 39.5","Washington <br> Beef 59.2 Dairy 154.18 <br> Fruits 1738.57 Veggies 363.79 <br> Wheat 786.3 Corn 29.5","West Virginia <br> Beef 12 Dairy 3.9 <br> Fruits 11.54 Veggies 0 <br> Wheat 1.6 Corn 3.5","Wisconsin <br> Beef 107.3 Dairy 633.6 <br> Fruits 133.8 Veggies 148.99 <br> Wheat 96.7 Corn 460.5","Wyoming <br> Beef 75.1 Dairy 2.89 <br> Fruits 0.17 Veggies 10.23 <br> Wheat 20.7 Corn 9"],"locations":["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"],"locationmode":"USA-states","marker":{"line":{"color":"rgba(255,255,255,1)","width":2}},"type":"choropleth","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<p>It is also possible to create animated images!</p>
<p><!--
  Ex Arthur ou flowing ou simple map.
**Practice**
  
  The Cleveland dots are a lighter way to display counts
Spatial, density sur map
graphs réseau.

ggplot(data = LFB, aes(x = reorder(IncGeo_BoroughName, IncGeo_BoroughName, length))) +
  geom_point(stat = "count") + coord_flip() +
  theme(panel.grid.major.x = element_blank() ,
        panel.grid.major.y = element_line(linetype = "dotted", color = "darkgray")) +
  xlab("IncGeo_BoroughName")
ggplotly(p)


ggplot(data = LFB, aes(x = FirstPumpArriving_AttendanceTime, y = SecondPumpArriving_AttendanceTime)) + geom_hex()

--></p>
</div>
<div id="going-further" class="section level2">
<h2><span class="header-section-number">5.5</span> Going further</h2>
<div id="cross-validation" class="section level3">
<h3><span class="header-section-number">5.5.1</span> Cross-validation</h3>
<p>Assume that the data are modeled as <span class="math inline">\(n\)</span> independent and identically distributed random variables <span class="math inline">\((X_1,\ldots,X_n)\)</span> with the same unknown probability distribution <span class="math inline">\(p_{\star}\)</span> with respect to the Lebesgue measure on <span class="math inline">\(\mathbb{R}\)</span>. A kernel density estimate of <span class="math inline">\(p_{\star}\)</span> with bandwith <span class="math inline">\(h_n\in\mathbb{R}_{+}^{\star}\)</span> and kernel <span class="math inline">\(K:\mathbb{R}\to \mathbb{R}\)</span> is given by: <span class="math display">\[
\hat{p}_{n,h_n}: x\mapsto \frac{1}{nh_n}\sum_{i=1}^{n}K\left(\frac{x-X_i}{h_n}\right)\,.
\]</span> The performance of this estimator is highly sensitive to the choice of the bandwith <span class="math inline">\(h_n\)</span>. For instance, in the case where <span class="math inline">\(p_{\star}\)</span> is twice continuously differentiable with <span class="math inline">\(p_{\star}\)</span> and <span class="math inline">\(p&#39;&#39;_{\star}\)</span> uniformly bounded and when <span class="math inline">\(K\)</span> is such that <span class="math inline">\(\int K(u) \mathrm{d}u = 1\)</span>, <span class="math inline">\(\int uK(u) \mathrm{d}u = 0\)</span>, <span class="math inline">\(\int u^2|K(u) |\mathrm{d}u &lt;\infty\)</span> and <span class="math inline">\(\int |K(u)|^2 \mathrm{d}u &lt;\infty\)</span>, there exists <span class="math inline">\(c&gt;0\)</span> such that for all <span class="math inline">\(x\in\mathbb{R}\)</span>: <span class="math display">\[
\left|\mathbb{E}\left[\hat{p}_{n,h_n}(x)\right] - p_{\star}(x)\right|\le ch_n^2\quad\mbox{and}\quad \mathbb{V}\left[\hat{p}_{n,h_n}(x)\right] \le \frac{c}{nh_n}\,.
\]</span> Therefore, in this case, minimizing the mean square error leads to set <span class="math inline">\(h_n \propto n^{-1/5}\)</span>. However, this optimal choice depends on the smoothness assumptions on the unknown density <span class="math inline">\(p_{\star}\)</span> (through the constant <span class="math inline">\(c\)</span>) which makes them useless in practice. Other assumptions on <span class="math inline">\(p_{\star}\)</span> (Lipschitz, local Hölder continuity of a given order) provide other rates of convergence but with no practical rules to choose <span class="math inline">\(h_n\)</span>.</p>
<p>A common strategy to obtain a data driven choice of <span class="math inline">\(h_n\)</span> is to minimize the integrated mean square error: <span class="math display">\[
h_n = \mbox{Argmin}_{h&gt;0} \; \mathbb{E}\left[\ \int \left(\hat{p}_{n,h}(x)-p_{\star}(x)\right)^2 \mathrm{d}x\right]\,.
\]</span> This amounts to computing: <span class="math display">\[
h_n = \mbox{Argmin}_{h&gt;0} \; \mathsf{I}_n(h) = \mathbb{E}\left[\int \left(\hat{p}_{n,h}(x)\right)^2\mathrm{d}x - 2 \int \hat{p}_{n,h}(x)p_{\star}(x) \mathrm{d}x\right]\,.
\]</span> The function <span class="math inline">\(h\mapsto \mathsf{I}_n(h)\)</span> cannot be minimized as it depends on the unknown density <span class="math inline">\(p_{\star}\)</span>. Therefore, Cross-validation minimizes an empirical surrogate criterion to define <span class="math inline">\(\hat{h}_n\)</span>: <span class="math display">\[
\hat{h}_n = \mbox{Argmin}_{h&gt;0} \; \mathsf{\hat{I}}_n(h) = \int\left(\hat{p}_{n,h}(x)\right)^2\mathrm{d}x - \frac{2}{n}\sum_{i=1}^n\left(\frac{1}{(n-1)h}\sum_{j=1,j\neq i}^n K\left(\frac{X_j-X_i}{h}\right)\right)\,.
\]</span> For all <span class="math inline">\(h&gt;0\)</span>, <span class="math inline">\(\mathsf{\hat{I}}_n(h)\)</span> is an unbiased estimator of <span class="math inline">\(\mathsf{I}_n(h)\)</span>. It can be computed explicitly from the observations as long as <span class="math inline">\(\int\left(\hat{p}_{n,h}(x)\right)^2\mathrm{d}x\)</span> is available which is straightforward for usual kernel choices.</p>
<p>The following function computes the best <span class="math inline">\(h\)</span> on a given grid when <span class="math inline">\(K\)</span> is a Gaussian kernel <span class="math inline">\(K:x\mapsto (2\pi)^{-1/2}\mathrm{e}^{-x^2/2}\)</span>.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="reproducible.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="homework-exploratory-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-Graphics.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
